{"code":"!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=1)}([function(e,t){var r,n,i=e.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r=\"function\"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n=\"function\"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&f())}function f(){if(!l){var e=a(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function d(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new g(e,t)),1!==u.length||l||a(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=d,i.addListener=d,i.once=d,i.off=d,i.removeListener=d,i.removeAllListeners=d,i.emit=d,i.prependListener=d,i.prependOnceListener=d,i.listeners=function(e){return[]},i.binding=function(e){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(e){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},function(e,t,r){\"use strict\";\n/**\n * @module libbetter\n * @sub-module BetterLog\n * @sub-module BetterEvents\n * @sub-module BetterUtil.browser\n * @description This file can be built with webpack to create a file that can be loaded directly\n *\t\t\t\tby the browser and will make the sub-modules available on window\n *\n * @author plundell\n * @license MIT\n */window.BetterLog=r(2),window.BetterEvents=r(3),r(4)(window)},function(e,t,r){(function(t,r){!function(n){if(e.exports){e.exports=f;var i=\"terminal\"}else n.BetterLog=f,i=\"browser\";const o=[{str:\"trace\",STR:\"TRACE\",nr:1,colorTerm:96,colorBrow:\"background:cyan;color:black\",print:console.debug},{str:\"debug\",STR:\"DEBUG\",nr:2,colorTerm:94,colorBrow:\"background:#5862f3;color:white\",print:console.debug},{str:\"info\",STR:\"INFO\",nr:3,colorTerm:92,colorBrow:\"background:#3bd473;color:black\",print:console.log},{str:\"note\",STR:\"NOTE\",nr:4,colorTerm:93,colorBrow:\"background:#f23dfb;color:white\",print:console.warn},{str:\"warn\",STR:\"WARN\",nr:5,colorTerm:91,colorBrow:null,print:console.warn},{str:\"error\",STR:\"ERROR\",nr:6,colorTerm:101,colorBrow:null,print:console.error}],s={};o.forEach(e=>{s[e.str]=e,s[e.nr]=e});const a={red:{colorTerm:41,colorBrow:\"red\"},blue:{colorTerm:44,colorBrow:\"blue\"},magenta:{colorTerm:45,colorBrow:\"magenta\"},green:{colorTerm:42,colorBrow:\"green\"},yellow:{colorTerm:43,colorBrow:\"yellow\"}};function c(e=3,t=3){return s.hasOwnProperty(e)?s[e].nr:t}const u={autoPrintLvl:5,lowestLvl:1,appendSyslog:!0,printStackLvl:0,printStackLines:0,hideParentStack:!1,printColor:!0,printWhere:!0,printFunc:!0,printId:!1,printTime:!1,printMs:!0,printSelfOnLvl:0,name:null,namePrefix:!1,breakOnError:!1,extraLength:400,hideInternalStack:!0,rootPath:!(\"object\"!=typeof t||!t||!t.cwd)&&t.cwd(),fileOnly:!0,hideThisFileStack:!0};var h,p;try{10==Error.stackTraceLimit&&(Error.stackTraceLimit=20)}catch(e){console.error(e)}function f(e,t={}){const r=this;if(Object.defineProperty(this,\"_isBetterLog\",{value:!0}),this.options=Object.assign({},u,t),f._instances.has(e))throw console.error(\"Existing BetterLog unit \",e,f._instances.get(e)),new Error(\"BetterLog unit already exists (see previous console.error)\");function n(e,t,...r){try{e.nr>=this.options.lowestLvl&&this.makeEntry.apply(this,[e.nr,t].concat(r)).exec()}catch(n){console.error(`BUGBUG BetterLog.${e.str}():`),console.error(n,n.stack),console.error(\"Arguments:\",t,r)}}this.unit=e,f._instances.set(e,this),this.changeName(this.options.name),h||this.resetStartTime(),this.entries=Array(),Object.defineProperty(this,\"_listeners\",{value:[]}),this.codes={},o.forEach(e=>{Object.defineProperty(this,e.str,{enumerable:!0,value:n.bind(this,e)})}),this.traceFunc=function(...e){try{1==r.options.lowestLvl&&r.makeTrace.apply(r,e).exec()}catch(e){console.error(\"BUGBUG\",e)}},this.throw=function(...e){r.error.apply(r,e).throw()},this.throwType=function(...e){r.makeTypeError.apply(r,e).throw()},this.reject=function(...e){var t=r.error.apply(r,e);return Promise.reject(t)},this.rejectType=function(){try{r.throwType.apply(r,Object.values(arguments))}catch(e){return Promise.reject(e)}},this.highlight=function(...e){var t=\"red\";return\"string\"==typeof e[0]&&a.hasOwnProperty(e[0])&&(t=e.shift()),o.hasOwnProperty(e[0])||e.unshift(\"note\"),r.makeEntry.apply(r,e).highlight(t).exec()},this.throwCode=function(e){r.makeCodeError(e).throw()}}function g(e){var t=new Map(e),r=t.has.bind(t),n=t.get.bind(t),i=t.set.bind(t),o=t.delete.bind(t),s=new Map;function a(e){return r(e)||!s.has(e)?e:s.get(e)}var c=[\"set\",\"get\",\"has\",\"delete\"];return Object.defineProperties(t,{aliases:{value:s},has:{value:function(e){return r(a(e))}},get:{value:function(e){return n(a(e))}},set:{value:function e(r,o){return\"string\"!=typeof(r=a(r))||t.hasOwnProperty(r)||Object.defineProperty(t,r,{configurable:!0,get:()=>n(r),set:t=>e(r,t)}),i(r,o)}},delete:{value:function(e){return\"string\"!=typeof(e=a(e))||c.includes(e)||delete t[e],o(e)}}}),t}function d(e){if(\"object\"==typeof e){if(null==e)return\"null\";switch(e.constructor.name){case\"Object\":return\"object\";case\"Array\":return\"array\"}if(w._isBLE(e))return\"ble\";if(e instanceof Error)return\"error\";if(e instanceof Promise)return\"promise\";var t=Object.prototype.toString.call(e);return\"[object HTMLCollection]\"===t||\"[object NodeList]\"===t?\"nodelist\":t.includes(\"[object HTML\")||t.includes(\"[object SVG\")?\"node\":\"object\"}return typeof e}function y(e,t=300,...r){if(1==r.length&&\"number\"==typeof r[0])var n=r[0];var i=n||r.includes(\"noType\"),o=f.varType(e),s=o;switch(o){case\"undefined\":case\"null\":return\"<\"+s+\">\";case\"ble\":return`<(ble)${e.toString()}>`;case\"error\":return`<${e.constructor.name}:${e.message}>`;case\"object\":if(\"Object\"==e.constructor.name){e=m(e,t,o,n);break}if(E(e))return`<(ble)${f._syslog.makeEntry(e.lvl,e).toString()}>`;s=\"<\"+e.constructor.name+\">\";var a=String(e);if(Object.prototype.toString.call(e)!=a)e=a,o=\"pleaseshortenmyobject\";else{if(n)return s;e=m(e,t,o,n)}break;case\"array\":e=m(e,t,o,n);break;case\"function\":var c=String(e);if((e=c.slice(0,c.indexOf(\")\")+1)).indexOf(\"function\")>-1){if(e+=\"{}\",\"x\"==t)return e;e=e.replace(\"function \",\"\")}else e+=\"=>{}\";break;case\"node\":let r=e.id?\"#\"+e.id:\"\",i=e.classList.length?\".\"+e.classList.toString().replace(\" \",\".\"):\"\";e=e.tagName.toLowerCase()+r+i;break;case\"string\":e=`\"${e}\"`;break;case\"promise\":default:e=String(e)}if(t&&e.length>t&&\"object\"!=o&&\"array\"!=o){let r=e.match(/([\\}\\]\\)\"])$/);e=e.slice(0,t)+\"...\",r&&(e+=r[1])}return i?e:\"(\"+s+\")\"+e}function m(e,t,r,n=0){try{var i;if(n){if(n>5*t)return String(e);if(n>3*t)return JSON.stringify(e)}else if(t<51)return(i=JSON.stringify(e)).substr(0,t-4)+\"...\"+i.substr(-1)}catch(e){}try{n++;var o=Object.getOwnPropertyNames(e);\"array\"==r&&o.splice(o.indexOf(\"length\"),1);for(var s={},a=[],c=0,u=0,l=o.length,h=Math.floor(t/l);u<l;u++){let r=o[u];try{i=y(e[r],t,n)}catch(e){i=`<err:${e.message}>`}s[r]=i;let l=i.length;n+=l,l<h?c+=h-l:a.push(r)}if(\"object\"==r){let e=o.join(\"\").length;n+=e,c=Math.max(c-e,0)}if(n>t){var p=a.splice(5,a.length);p.length?(o=o.filter(e=>0==p.includes(e)),h=Math.floor(t/a.length)):p=void 0,h+=Math.floor(c/a.length),a.forEach((e,t)=>{if(s[e].length>h){let t=s[e].substr(0,h-3)+\"...\"+s[e].substr(-1);s[e]=t}})}var f=t=>{e.propertyIsEnumerable(t)||(i+=\"*\"),i+=`${t}:${s[t]}, `};return\"array\"==r?(i=\"[\",o.forEach(e=>{isNaN(Number(e))?f(e):i+=s[e]+\", \"})):(i=\"{\",o.forEach(e=>f(e))),p?i+=`<${p.length} more>`:i=i.replace(/, $/,\"\"),i+=\"array\"==r?\"]\":\"}\"}catch(r){try{return console.warn(r),console.verbose(e),(i=JSON.stringify(e)).substr(0,t-4)+\"...\"+i.substr(-1)}catch(e){return`<err:${e.message}. See console.verbose^>`}}}function b(e){try{if(!e)return{where:\"unknown\",func:\"unknown\"};var t=(e=e.replace(/^\\s*at /,\"\").trim()).indexOf(\"(\"),r=e.substring(t+1);return obj={where:\")\"==r.substring(r.length-1)?r.substring(0,r.length-1):r,func:e.substring(0,t-1)}}catch(e){return{where:\"unknown\",func:\"unknown\"}}}function v(e){return e.split(/\\r\\n|\\r|\\n/).slice(1)}function w(e,t,r,n,i){var o;for(this.id=null,Object.defineProperties(this,{_code:{enumerable:!1,configurable:!0,writable:!0,value:null},code:{enumerable:!0,get:this.getCode.bind(this),set:this.setCode.bind(this)},_options:{value:{}},options:{enumerable:!0,get:()=>Object.assign({},this.log.options,this._options),set:this.setOptions.bind(this)},_isBetterLogEntry:{value:!0},_rocks:{value:[]},_age:{get:()=>Date.now()-this.timestamp}}),this.lvl=c(t,4),this.msg=r,this.extra=Array.isArray(n)?n:null!=n?[n]:[],this.timestamp=Date.now(),this.handling=[],this.log=f._isLog(e)?e:f._syslog,this.setStack(i),this.printed=!1,this.bubble=null,o=0;o<this.extra.length;o++){let e=this.extra[o];if(\"object\"==typeof e&&(w._isBLE(e)?this.bubble=this.extra.splice(o,1)[0]:(e instanceof Error||E(e))&&(this.bubble=this.log.makeEntry(e.lvl||6,this.extra.splice(o,1)[0])),this.bubble)){this.bubble._rocks.push(this);break}}return this}function E(e){return e&&\"object\"==typeof e&&e.__ble}function O(e){this.printed=!0;var t=[];if((e=Object.assign({},s[this.lvl],e)).printId&&t.push(\"#\"+String(this.id),\"-\"),e.printMs)t.push(String(this.timestamp-h),\"-\");else if(e.printTime){var r=\"function\"==typeof e.printTime?e.printTime(this.timestamp):this.timestamp;t.push(r,\"-\")}var n=e.name||this.log?this.log.name:\"\";if(n){if(e.printFunc&&this.func){var i=this.func.replace(n,\"\").replace(/Object\\.<anonymous>/,\"\");this.log&&\"object\"==typeof this.log.unit&&(i=i.replace(this.log.unit.constructor.name,\"\")),i&&(n=(n+\".\"+i).replace(\"..\",\".\"))}}else n=e.printFunc?this.func+\"()\":this.where;if(e.namePrefix&&(n=e.namePrefix+n),n&&(n=\"[\"+n+\"]\",e.printColor&&(\"terminal\"==f._env?n=T(n,33):(n=\"%c\"+n+\"%c\",e.colorBrow=[\"font-weight:bold\",\"font-weight:initial\",e.colorBrow])),t.push(n,\"-\")),e.printColor)switch(f._env){case\"browser\":e.colorBrow?t=[t.join(\" \")+` %c ${e.STR} `].concat(e.colorBrow):t.push(e.STR);break;case\"terminal\":default:t.push(T(e.STR,e.colorTerm))}else t.push(e.STR);if(t.push(\"-\"),x(t,\"\",this._code,this.msg,this.where,this.extra,e,3),e.printStackLvl&&this.lvl>=e.printStackLvl){k(t);let r=\" \".repeat(3);var o=this.stack.slice(0,e.printStackLines||100);o.length&&(t.push(`${r}[Stack]`),t.push.apply(t,o.map(({func:e,where:t})=>`\\n${r} | ${e} (${t})`)))}return this.handling&&this.handling.forEach(({what:r,where:n,extra:i})=>{k(t),x(t,\" --\\x3e\",null,r,n,i,e,\" --\\x3e\".length+2)}),e.printSelfOnLvl<=this.lvl&&\"browser\"==f._env&&(k(t),t.push(this)),t[0]=String(t[0]),Object.defineProperty(t,\"print\",{value:s[this.lvl].print}),t}function T(e,...t){return t.map(e=>\"\u001b[\"+e+\"m\").join(\"\")+e+\"\u001b[0m\"}function k(e,t=0){let r=e.length-1,n=e[r];t=\"string\"==typeof t?t:\" \".repeat(t),\"string\"!=typeof n?e.push(\"\\n\"+t):t&&n.match(/\\n$/)?e[r]+=t:n.match(/\\n$/)||e.push(\"\\n\"+t)}f._env=i,f._BetterLogEntry=w,f.varType=d,f.logVar=y,f.parseStackLine=b,f.BetterMap=g,f._instances=g(),Object.defineProperty(f,\"_sourceMap\",{value:{}}),Object.defineProperties(f._sourceMap,{cache:{value:{},writable:!0},add:{value:function(e,t){if(\"string\"!=typeof e||\"string\"!=typeof t)throw new TypeError(\"Expected 2 strings, the full path and the sourcemap string, got: \"+y(e)+\" , \"+y(t));f._sourceMap[e]=t.split(\";\").map(e=>{let t=e.split(\"=\");return t[0]=Number(t[0])-1,t}).filter(e=>2==e.length&&\"number\"==typeof e[0]&&\"string\"==typeof e[1]),f._syslog.info(\"Added simpleSourceMap for \"+e,f._sourceMap[e]),f._sourceMap.cache={}}},lookup:{value:function(e,t=!1){if(f._sourceMap.cache.hasOwnProperty(e))return f._sourceMap.cache[e];var r=e.split(\":\"),n=r.pop(),i=r.pop(),o=r.join(\":\");if(f._sourceMap.hasOwnProperty(o)){let r=f._sourceMap[o];for(let o=r.length-1;o>=0;o--)if(i>r[o][0]){if(!r[o][1])break;var s=`${r[o][1]}:${i-r[o][0]}:${n}`;return t&&(s=document.location.origin+s),f._sourceMap.cache[e]=s,s}}f._sourceMap.cache[e]=void 0}},length:{get:function(){return Object.keys(f._sourceMap).length}}}),f.prototype._isLog=f._isLog=function(e){return!(!e||\"object\"!=typeof e||\"BetterLog\"!=e.constructor.name)&&(e instanceof f||f._syslog.warn(\"BetterLog has been exported at least twice:\",f._syslog,e.constructor._syslog),!0)},f.prototype.toString=function(){switch(f.varType(this.unit)){case\"string\":return this.unit;case\"object\":return this.unit.constructor.name;case\"function\":return this.unit.name;default:return\"BetterLog\"}},f.prototype.changeName=function(e){if((e=(\"string\"==typeof e?e:\"\")||this.toString())!==this.unit&&e!==this.name){for(var t=e,r=0;f._instances.has(e);)e=t+ ++r;f._instances.aliases.set(e,this.unit)}this.name=e},Object.defineProperty(f,\"defaultOptions\",{enumerable:!0,value:{}}),Object.defineProperties(f.defaultOptions,{get:{enumerable:!0,value:function(){return JSON.parse(JSON.stringify(u))}},set:{enumerable:!0,value:function(e,t=!1){if(\"object\"!=typeof e)throw new TypeError(\"Expected object, got: (\"+typeof e+\")\"+String(e));e.hasOwnProperty(\"env\")&&(f._env=e.env,delete e.env),Object.assign(u,e),t?f._instances.forEach(t=>Object.assign(t.options,e)):Object.assign(f._syslog.options,e)}}}),f.prototype.makeEntry=function(e,t,...r){var n=c(e,\"a\");if(\"a\"==n&&(null!=t&&r.unshift(t),t=e,e=3),w._isBLE(t))return t.lvl=n,t.log=this,r.length&&(t.extra=t.extra.concat(r),t.printed=!1),t;if(t instanceof Error){if(t instanceof SyntaxError){var i,o=\"\",s=t.stack.split(/\\r\\n|\\r|\\n/),a=s.length;for(i=1;i<a&&!s[i].match(\"SyntaxError: \");i++)o+=\"\\n\"+s[i];r.unshift(o)}var u=new w(this,e,t.message,r,t.stack);return t.code?u.setCode(t.code):\"Error\"!=t.name&&u.setCode(t.name),u}return E(t)?((u=new w(this,e,t.msg,t.extra.concat(t.bubble,r),t.stack)).code=t.code,u.timestamp=t.timestamp,u.handling=t.handling,u.printed=!r.length&&t.printed,u):new w(this,e,t,r)},f.prototype.makeEntryRaw=function(e,t,r,n){return new w(this,e,t,r,n)},f.prototype.makeError=function(...e){return e.unshift(6),this.makeEntry.apply(this,e)},f.prototype.makeTrace=function(e,t,r=1){if(r=c(r),\"string\"==typeof e){var n=e;e=t,t=n}var i;\"object\"!=typeof e?i=\"( ? )\":i=`( ${0==(e=Object.values(e).map(e=>y(e,40))).length?\" void \":e.join(\" , \")} )`;var o=this.makeEntry(r,i,void 0);return t&&\"string\"==typeof t&&(t.includes(\" \")?o.extra.push(t):(o.func=t,o._options.printFunc=!0)),o.addFrom(),o},f.prototype.makeTypeError=function(e,...t){switch(d(e)){case\"array\":e=e.join(\"|\");break;case\"object\":e=\"instanceof \"+e.constructor.name;break;case\"function\":e=\"instanceof \"+e.name;break;case\"string\":break;default:e=\"(bugbug)\"+String(e)}return this.makeError(`Expected ${e}, got: `).addExtra(...t).setCode(\"TypeError\")},f.prototype.makeCodeError=function(e,t){var r=\"\";return this.codes&&this.codes[e]&&(r=this.codes[e]),this.makeError(r).setCode(e).append(t)},f.prototype.emit=function(e){try{if(!this._listeners.length)return;for(var t=this._listeners.length-1;t>=0;t--)if(this._listeners[t]){var[r,n,i]=this._listeners[t];if(e.lvl<n||e.lvl>i)return;try{r(e)}catch(n){console.error(`Uncaught error in BetterLog listener ${t}:`,n,r,e)}}}catch(t){console.error(\"BUGBUG BetterLog.emit():\",t,e)}},f.prototype.listen=function(e,t=1,r=6){return\"function\"!=typeof e&&(e=f.prototype.print),this._listeners.push([e,c(t,1),c(r,6)])-1},f.prototype.ignore=function(e){this._listeners.hasOwnProperty(e)&&delete this._listeners[e]},f.prototype.extend=function(e){if(!f._isLog(e)||e===this)throw new TypeError(\"Expected another instance of BetterLog, got: \"+y(e));var t=this;e.listen((function(e){t.entries.push(e),t.emit(e)}))},f.prototype.replace=function(e){if(!f._isLog(e)||e===this)throw new TypeError(\"Expected another instance of BetterLog, got: \"+y(e));this.note(\"This log will be replaced by: \",e.name);var t=0;for(l=this.entries.length,e.debug(`Replacing log '${this.name}'. Grabing it's ${l} entries.`);t<l;t++)e.entries.push(this.entries[t]);return f._instances.delete(this.unit),e},f.prototype.resetStartTime=function(){h=Date.now()},f.prototype.get=function(e=1,t){var r;if(e=c(e,1),t){let e=f._instances.get(t);if(!e)return console.warn(\"No such BetterLog unit setup:\",t),[];r=e.entries}else r=null!==t&&f._isLog(this)?this.entries:f._syslog.entries;return r.filter(t=>t.lvl>=e)},f.prototype.find=function(e={}){var t=this.get(e.lowestLvl||1,e.unit);if(!t.length)return[];if(e.hasOwnProperty(\"printed\")&&t.filter(t=>t.printed==e.printed),!t.length)return[];if(\"number\"==typeof e.rocks&&(e.id=[e.rocks,e.rocks]),Array(\"id\",\"timestamp\").forEach(r=>{if(e[r]&&!(t=Array.isArray(e[r])?t.filter(t=>t[r]>=e[r][0]&&t[r]<=e[r][1]):t.filter(t=>t[r]>=e[r])).length)return[]}),e.rocks){var r=e=>{var t=[e];return e._rocks.length&&e._rocks.forEach(e=>{t.push.apply(t,r(e))}),t};let e=[];t.forEach(t=>e.push.apply(e,r(t))),t=e.filter(e=>0==e._rocks.length)}return e.match&&(t=t.filter(t=>{try{return t.msg.match(e.match)}catch(e){return!1}})),t},f.prototype.dump=function(e={},t){e=Object.assign({printMs:!1},e);var r=\"object\"==typeof t?this.find(t):this.get();r.length?r.forEach(t=>{t.printed=!1,t.print(e)}):console.log(\"No matching entries found.\")},f.prototype.last=function(){return this.entries[this.entries.length-1]},f.prototype.getStackArray=function(e){var t,n;if(Array.isArray(e)&&\"object\"==typeof e[0])t=e,n=\"[original stack lost]\"==e.original?\"[original stack lost by parent]\":e.original||'[BUGBUG: prop \"original\" not set on pre-processed stack array]';else{if((n=\"string\"==typeof e?e:e instanceof Error?e.stack:Error().stack).match(\"SyntaxError: \"))return function(e){var t=e.split(/\\r\\n|\\r|\\n/);return t=[{func:\"unknown\",where:t[0]}],Object.defineProperty(t,\"original\",{value:e}),t}(n);t=(t=n.match(\"ReferenceError: \")?function(e){var t,r=e.split(/\\r\\n|\\r|\\n/);if(\"ReferenceError:\"==r[0].substr(0,15))return r.shift(),r;for(t=[r.shift()];;){let e=r.shift();if(null==e||e.includes(\"ReferenceError:\"))break}return t.concat(r)}(n):v(n)).map(b),\"terminal\"==f._env?(t=t.filter(e=>0==e.where.includes(r)),this.options.hideInternalStack&&(t=t.filter((e,t)=>0===t||!e.where.includes(\"internal/modules\")&&(0!=e.where.indexOf(\"vm.js:\")&&(0!=e.where.indexOf(\"module.js:\")&&!e.where.includes(\"bootstrap_node.js:\"))))),this.options.fileOnly?t.forEach(e=>e.where=e.where.slice(e.where.lastIndexOf(\"/\")+1)):t.forEach(e=>e.where.replace(this.options.rootPath,\".\"))):(f._sourceMap.length&&t.forEach(e=>e.where=f._sourceMap.lookup(e.where,!0)||e.where),this.options.hideThisFileStack?function(e){if(!p){var t=b(v(Error().stack)[0]).where;p=t.substr(0,t.indexOf(\".js:\"))+\".js\"}var r=0,n=e.length;for(;r<n&&0==e[r].where.indexOf(p);r++);e.splice(0,r)}(t):t=t(t).filter(e=>e.func.includes(\"BetterLog\")))}return Object.defineProperty(t,\"original\",{value:n||\"[original stack lost]\"}),t.length||t.push({empty:!0}),t},w.prototype=Object.create(Error.prototype),Object.defineProperty(w.prototype,\"constructor\",{value:w}),w.prototype._isBLE=w._isBLE=function(e){return!(!e||\"object\"!=typeof e||\"BetterLogEntry\"!=e.constructor.name||\"function\"!=typeof e.changeWhere)&&(!e.log||e.log instanceof f||f._syslog.warn(\"BetterLog has been exported at least twice:\",f._syslog,e.log.constructor._syslog),!0)},w.prototype.toJSON=function(){return{log:this.log.name,id:this.id,code:this.code,lvl:this.lvl,msg:this.msg,extra:this.extra,timestamp:this.timestamp,printed:this.printed,handling:this.handling,stack:this.stack,where:this.where,func:this.func,bubble:this.bubble?this.bubble.toJSON():null,__ble:!0}},w.prototype.toString=function(){return x([],null,this._code,this.msg,null,this.extra,this.options).map(e=>y(e,300,\"noType\")).join(\" \").replace(\"\\n\",\" \")},w.prototype.getCode=function(){for(var e=this;e;){if(e._code)return e._code;e=e.bubble}return null},w.prototype.setCode=function(e=null,t=!1){return t&&this.getCode()||(\"string\"==typeof e||\"number\"==typeof e?this._code=e:console.warn(\"BetterLogEntry.code can only be string or number, got:\",y(e))),this},w.prototype.setOptions=function(e){return e&&\"object\"==typeof e?Object.assign(this._options,e):console.warn(new TypeError(\"Cannot set options on BetterLogEntry. Expected object.\"),e),this},w.prototype.highlight=function(e,t=null,r=null){e=\"string\"==typeof e&&a.hasOwnProperty(e)?e:\"red\";var n=a[e];return this.setOptions({colorTerm:String(`${n.colorTerm};${s.note.colorTerm}`),colorBrow:`background:${n.colorBrow}`,autoPrintLvl:1}),this},w.prototype.setStack=function(e){return this.stack=this.log.getStackArray(e),this.where=this.stack[0].where,this.func=this.stack[0].func,this},w.prototype.changeWhere=function(e){return this.stack.splice(0,e),this.setStack(this.stack)},w.prototype.addFrom=function(){if(this.stack.length>1){var{func:e,where:t}=this.stack[1];this.append(` from ${e} (${t})`)}else console.warn(\"Why is stack so short? Cannot trace...\",this),this.append(\" from UNKNOWN\");return this},w.prototype.changeLvl=function(e){return this.lvl=c(e),this},w.prototype.addHandling=function(e,...t){try{var r=this.log.getStackArray(\"object\"==typeof e&&e.stack?e.stack:void 0);this.handling.push({where:r[0].where,what:e,extra:t})}catch(e){console.error(\"Not adding handling to entry.\",e)}return this},w.prototype.prepend=function(e){if(\"string\"!=typeof e)return this;if(\"string\"==typeof this.msg){if(this.msg.toLowerCase().replace(/[.:,;]/g,\"\").includes(e.toLowerCase().replace(/[.:,;]/g,\"\")))return this;e[e.length-1].match(/\\s/)||(e+=\" \"),this.msg=e+this.msg}else this.extra.unshift(this.msg),this.msg=e;return this},w.prototype.append=function(e){if(\"string\"!=typeof e)return this;if(\"string\"!=typeof this.msg||this.extra.length&&\"string\"==typeof this.extra[0]){for(var t=!0,r=0,n=this.extra.length;r<n;r++)if(\"string\"!=typeof this.extra[r])this.extra.splice(r,e),t=!1;else if(this.extra[r].match(/\\/n/)){let t=this.extra[r].split(\"/n\");t.splice(1,e),this.extra[r]=t.join(\"/n\")}t&&this.extra.push(e)}else this.msg+=e;return this},w.prototype.somewhere=function(e){for(var t=this;t;){if(\"string\"==typeof t.msg&&t.msg.includes(e))return this;if(t.extra.find(t=>\"string\"==typeof t&&t.includes(e)))return this;t=t.bubble}return this.extra.push(e),this},w.prototype.addExtra=function(...e){return\"terminal\"==f._env&&(e=e.map(e=>y(e,100))),this.extra.push.apply(this,e),this},w.prototype.exec=function(e){return this.options.appendSyslog?(this.id=f._syslog.entries.push(this)-1,this.log.entries.push(this)):this.id=this.log.entries.push(this)-1,this.log.emit(this),this.options.appendSyslog&&f._syslog.emit(this),this.options.autoPrintLvl&&this.lvl>=this.options.autoPrintLvl&&0==this.printed&&this.print(),6==this.lvl&&this.options.breakOnError,this},w.prototype.reject=function(e,t){return e&&this.setCode(e,t),Promise.reject(this)},w.prototype.throw=function(e,t){throw e&&this.setCode(e,t),this},w.prototype.print=function(e={},t=null){try{for(var r=f._isLog(t)?t:this.log,n=Object.assign({},r.options,this._options,e),i=[],o=this;o.bubble;)if((o=o.bubble).printed){let e=[\"See previously printed entry \",o.id?\"#\"+o.id:y(o.msg,18,\"noType\")];e.print=s[o.lvl].print,i.push(e)}else i.push(O.call(o,n));if(i.length){if(console.group(`--- ${s[this.lvl].STR} ---`),\"terminal\"==f._env)for(var a=i.length-1;a>=0;a--)console.group();else for(a=i.length-1;a>=0;a--)console.group(\" \");for(a=i.length-1;a>=0;a--)i[a].print.apply(null,i[a]),console.groupEnd()}var c=O.call(this,n);c.print.apply(null,c),i.length&&(console.groupEnd(),\"terminal\"==f._env&&console.log(\"--- end ---\"))}catch(e){console.error(\"BUGBUG: BetterLogEntry.print() failed.\",e,this)}return this};var j={browser:function(e,t,r){t.push(r)},terminal:function(e,t,r){t.push(\"object\"==typeof r?y(r,e):r)}};function x(e,t,r,n,i,o,s,a){var c=j[f._env].bind(e,s.extraLength);t=String(t||\"\"),(r||0===r)&&(t+=String(r)+\": \"),\"string\"==typeof n?c(e,t+n):t?(c(e,t),c(e,n)):c(e,n);var u=!1;return\"object\"==typeof n&&(C(i,s,e),u=!0,k(e)),o&&(Array.isArray(o)?o:[o]).forEach((t,r)=>{u||\"string\"==typeof t&&t.match(/\\n/)||\"object\"==typeof t&&(r>0||!(t instanceof Error))?(u||C(i,s,e),k(e,a),c(e,t),u=!0):c(e,t)}),u||C(i,s,e),e}function C(e,t,r){null!=e&&t.printWhere&&(e=\"@ \"+e.trim(),t.printColor&&\"terminal\"==f._env&&(e=T(e,33,100)+T(\".\",30)),r.push(e))}f._syslog=new f(\"_syslog\",{appendSyslog:!1})}(\"undefined\"!=typeof window?window:this||{})}).call(this,r(0),\"/index.js\")},function(e,t,r){\n/**\n * @module BetterEvents\n * @author plundell \n * @email qmusicplayer@protonmail.com\n * @license MIT\n * @description Advanced event emitter for NodeJS and browsers. \n *\n * This file can be 'required' or loaded directly in browser with <script src=\"/path/to/better_events.js\">\n */\n!function(t){e.exports?e.exports=function(){return n}:t.BetterEvents=n;const r={bufferDelay:1e3,groupTimeout:0,defaultIndex:0,onProgress:()=>{},runAs:\"this\"};function n(e={}){if(!this instanceof n)throw new Error(\"BetterEvents() should be new'ed or called as object which inherits from BetterEvents\");Object.defineProperty(this,\"_betterEvents\",{value:{emitted:{},after:{},buffer:{},intercept:{},options:s(e),onerror:\"function\"==typeof e.onerror?e.onerror:n.prototype._defaultEmitErrorHandler}}),this.removeAllListeners()}function i(e){if(null==e||null==e)return`<${\"\"+e}>`;var t=e.toString();t.length>50&&(t=t.slice(0,25)+\"...\"+t.slice(-25));var r=typeof e;return\"object\"==r&&(r=e.__proto__.constructor.name),`(${r})${t}`}function o(e,t,r){switch(t){case\"listener\":t=\"a listener function\";break;case\"interceptor\":t=\"an interceptor function\";break;case\"s_evt\":t=\"a string event\";break;case\"r_evt\":t=\"a <RegExp> event\";break;case\"evt\":case\"event\":t=\"a string or <RegExp> event\"}return`Arg #${e} should be ${t}, got: ${i(r)}`}function s(e,t){var n=Object.assign({},e,t),o=Object.assign({},r);if(n.bufferDelay){if(\"number\"!=typeof n.bufferDelay)throw new TypeError(\"Option 'bufferDelay' should be a number, got:\"+i(n.bufferDelay));o.bufferDelay=n.bufferDelay}if(n.groupTimeout){if(\"number\"!=typeof n.groupTimeout)throw new TypeError(\"Option 'groupTimeout' should be a number, got:\"+i(n.groupTimeout));o.groupTimeout=n.groupTimeout}if(n.onProgress){if(\"function\"!=typeof n.onProgress)throw new TypeError(\"Option 'onProgress' should be a function, got:\"+i(n.onProgress));o.onProgress=n.onProgress}if(n.exclude)if(\"function\"==typeof n.exclude)o.exclude=[n.exclude];else{if(!Array.isArray(n.exclude)||!n.exclude.all(e=>\"function\"==typeof e))throw new TypeError(\"Option 'exclude' should be a function or array of functions, got:\"+i(n.exclude));o.exclude=n.exclude}if(n.emitAs){if(!Array(\"this\",\"global\",\"empty\",\"status\").includes(n.emitAs))throw new RangeError(\"Option 'emitAs' should be one of 'this','global','empty','status', got:\"+i(n.emitAs));o.emitAs=n.emitAs}return o}function a(e,t){\"settings\"==e&&console.log(\"_getGroupedListeners exclude:\",t);var r=this.getListeners(e);!r.length&&this._betterEvents.onUnhandled&&r.push(this._betterEvents.onUnhandled),this._betterEvents.onAll.length&&(r=[].concat(this._betterEvents.onAll,r)),t&&t.forEach(e=>{let t=r.findIndex(({l:t})=>t==e);t>-1&&r.splice(t,1)});var n={};return r.forEach(e=>{let t=e.hasOwnProperty(\"i\")?e.i:0;(n[t]=n[t]||[]).push(e)}),n}n.prototype._defaultEmitErrorHandler=console.error,n.prototype.removeAllListeners=function(){return this._betterEvents.events={},this._betterEvents.regexp=[],this._betterEvents.onAll=[],this._betterEvents.onUnhandled=null,this},n.prototype.addListener=function(...e){var t=this._betterEvents,r={o:!1,i:t.options.defaultIndex};if(e.forEach(e=>{switch(typeof e){case\"function\":r.l=e;break;case\"boolean\":r.o=e;break;case\"number\":r.i=e;break;case\"string\":e.match(/^\\++$/)?r.i=t.options.defaultIndex+e.length:e.match(/^\\-+$/)?r.i=t.options.defaultIndex-e.length:r.e=e;break;case\"object\":e instanceof RegExp?r.e=e:r=e}}),\"function\"!=typeof r.l)throw new TypeError(\"No listener function passed, got: \"+JSON.stringify(r));if(\"string\"==typeof r.e){if(t.events.hasOwnProperty(r.e))(n=t.events[r.e].find(({l:e})=>e===r.l))?r=n:t.events[r.e].push(r);else t.events[r.e]=[r]}else{if(!(r.e instanceof RegExp))throw new TypeError(\"No event string or RegExp was passed, got: \"+JSON.stringify(r));var n;(n=t.regexp.find(({l:e,e:t})=>e===r.l&&t==r.e))?r=n:t.regexp.push(r)}return r.r=this.removeListener.bind(this,r.l,r.e),r},n.prototype.on=function(e,t){return this.addListener(e,t,!1)},n.prototype.once=function(e,t){return this.addListener(e,t,!0)},n.prototype.onUnhandled=function(e){if(!1===e||null===e)return this._betterEvents.onUnhandled=null,!1;if(\"function\"!=typeof e)throw new TypeError(o(1,\"listener\",e));this._betterEvents.onUnhandled={l:e}},n.prototype.onAll=function(e,t){if(\"function\"!=typeof e)throw new TypeError(o(1,\"listener\",e));var r=this._betterEvents,n=r.onAll.find(t=>t.l==e);n?\"number\"==typeof t&&(n.i=t):r.onAll.push({l:e,i:\"number\"==typeof t?t:r.options.defaultIndex})},n.prototype.alreadyEmitted=function(e){if(e instanceof RegExp)return Object.keys(this._betterEvents.emitted).find(t=>t.match(e));if(\"string\"==typeof e)return this._betterEvents.emitted.hasOwnProperty(e)?e:void 0;throw new TypeError(o(1,\"evt\",e))},n.prototype.clearEmitted=function(e){if(e instanceof RegExp)return Object.keys(this._betterEvents.emitted).filter(t=>!!t.match(e)&&delete this._betterEvents.emitted[t]);if(\"string\"==typeof e)return!!this._betterEvents.emitted.hasOwnProperty(e)&&delete this._betterEvents.emitted[e];throw new TypeError(o(1,\"evt\",e))},n.prototype.after=function(e,t,r,n){var i=this.alreadyEmitted(e);if(!i||!r)var o=this.addListener(e,t,r,n);if(i)try{var s=this._betterEvents.emitted[i];e instanceof RegExp&&(s=[i].concat(s)),t.apply(this,s)}catch(e){this._betterEvents.onerror(`after() event listener '${i}' failed:`,e,\"Called with args:\",s)}return o},n.prototype.afterAll=function(e,t){if(!e instanceof Array)throw new TypeError(o(1,\"an array of events\",e));if(\"function\"!=typeof t)throw new TypeError(o(2,\"a callback function\",t));var r={},n=e.length;e.forEach(e=>this.after(e,(...i)=>{if(r[e]=i,--n<1)try{t.call(this,r)}catch(e){console.log(e)}},!0))},n.prototype.getListeners=function(e){var t;if(\"string\"==typeof e)t=this._betterEvents.events[e]||[],this._betterEvents.regexp.forEach(r=>{e.match(r.e)&&t.push(r)});else{if(!(e instanceof RegExp))throw new TypeError(o(1,\"evt\",e));var r=e,n=this._betterEvents.events;for(e in t=[],n)e.match(r)&&(t=t.concat(n[e]))}return t=t.filter((e,r)=>t.indexOf(e)==r)},n.prototype.countListeners=function(e,t=!1){let r=this.getListeners(e).length;return r?r+this._betterEvents.onAll.length:t&&(this._betterEvents.onUnhandled||this._betterEvents.onAll.length)?-1*(this._betterEvents.onAll.length+(this._betterEvents.onUnhandled?1:0)):0},n.prototype.hasAnyListeners=function(e){return!(!this._betterEvents.onAll.length&&!this._betterEvents.onUnhandled)||this.hasListener(e)},n.prototype.hasListener=function(e,t){switch(typeof t){case\"function\":return!!this.getListeners(e).find(e=>e.l==t);case\"object\":if(t.hasOwnProperty(\"l\")&&\"function\"==typeof t.l)return this.getListeners(e).includes(t);default:throw new TypeError(\"Expected listener function or object returned by hasListener(), got: \"+String(t))}},n.prototype.getEvents=function(e){var t=[];if(e instanceof RegExp){var r;for(r in this._betterEvents.events)r.match(e)&&t.push(r)}else{if(void 0!==e)throw new TypeError(o(1,\"a <RegExp> or undefined\",r));t=t.concat(Object.keys(this._betterEvents.events),Object.values(this._betterEvents.regexp).map(([e])=>e).filter((e,t,r)=>r.indexOf(e)==t))}return t},n.prototype.removeListener=function(e,t){if(e instanceof Object&&null==t){if(!e.e)return;t=e.e,e=e.l}var r;if(\"string\"==typeof t){if(!(this._betterEvents.events[t]instanceof Array))throw new Error(\"No such event: \"+t);r=this._betterEvents.events[t]}else{if(!(t instanceof RegExp))throw new TypeError(o(2,\"evt\",t));r=this._betterEvents.regexp}let n=r.findIndex(({e:r,l:n})=>n==e&&r==t);if(n>-1)return r.splice(n,1)[0];throw new Error(\"No such listener: \"+i(e))},n.prototype.removeListeners=function(e){if(\"function\"!=typeof e)throw new TypeError(o(1,\"listener\",e));var t=[];function r(r,n){for(var i=r.length-1;i>=0;i--)r[i].l==e&&(t.push(n||r[i].e),r.splice(i,1))}return this._betterEvents.events.forEach(r),r(this._betterEvents.regexp),r(this._betterEvents.onAll,\"onAll\"),this._betterEvents.onUnhandled.l==e&&(t.push(\"onUnhandled\"),this._betterEvents.onUnhandled=null),t},n.prototype.removeEvent=function(e){let t=this._betterEvents,r=[];if(\"string\"==typeof e)Array.isArray(t.events[e])&&(r=t.events[e],delete t.events[e]);else{if(!(e instanceof RegExp))throw new TypeError(o(1,\"evt\",e));var n;for(e=e.toString(),n=t.regexp.length;n>-1;n--)t.regexp[n][0].toString()==e&&r.push(t.regexp.splice(n,1))}return r},n.prototype.off=function(){var e,t,r,n;for([r,n]of Object.entries(arguments))if(\"function\"==typeof n)t=n;else if(\"string\"==typeof n||n instanceof RegExp)e=n;else{if(!(n instanceof Object&&\"function\"==typeof n.l))throw new TypeError(`Expected string, <RegExp>, function or object, arg#${r} was: `+i(n));t=n}return t?e||\"function\"!=typeof t?this.removeListener(t,e)?1:0:this.removeListeners(t).length:this.removeEvent(e).length},n.prototype.interceptEvent=function(e,t){if(\"string\"!=typeof e)throw new TypeError(o(1,\"s_evt\",e));if(\"function\"!=typeof t)throw new TypeError(o(2,\"interceptor\",t));this._betterEvents.intercept[e]=t},n.prototype.stopIntercepting=function(e){if(\"string\"!=typeof e)throw new TypeError(o(1,\"s_evt\",e));delete this._betterEvents.intercept[e]},n.prototype.emitEvent=function(e,r,n){if(\"string\"!=typeof e)throw new TypeError(o(1,\"s_evt\",e));var i=this._betterEvents,c=(n=s(i.options,n)).onProgress,u=a.call(this,e,n.exclude),l=function(e,t=!1){let r={};Object.defineProperties(r,{results:{value:[]},groups:{value:Object.keys(e).sort()}});for(let n in e){r[n]={};for(let t in e[n])r[n][t]=\"waiting\";t||Object.defineProperties(r[n],{length:{value:Object.keys(r[n]).length},listeners:{value:e[n]},waiting:{get:()=>Object.values(r[n]).reduce((e,t)=>e+(\"waiting\"==t?1:0),0)},executing:{get:()=>Object.values(r[n]).reduce((e,t)=>e+(\"executing\"==t?1:0),0)},finished:{get:()=>Object.values(r[n]).reduce((e,t)=>e+(\"finished\"==t?1:0),0)},started:{get:()=>r[n].length>r[n].waiting},remaining:{get:()=>r[n].length-r[n].finished},done:{get:()=>0==r[n].executing&&r[n].started},progress:{get:()=>r[n].finished/r[n].length},names:{value:Object.values(e[n]).map(e=>e.l.name||\"anonymous\")},entries:{get:()=>r[n].names.map((e,t)=>[e,r[n][t],n,t])}})}return t||Object.defineProperties(r,{length:{value:Object.values(r).reduce((e,t)=>e+t.length,0)},listeners:{value:e},waiting:{get:()=>Object.values(r).reduce((e,t)=>e+t.waiting,0)},executing:{get:()=>Object.values(r).reduce((e,t)=>e+t.executing,0)},finished:{get:()=>r.results.length},progress:{get:()=>r.finished/r.length},groupsStarted:{get:()=>Object.values(r).reduce((e,t)=>e+(t.started?1:0),0)},groupsDone:{get:()=>Object.values(r).reduce((e,t)=>e+(t.done?1:0),0)},groupsExecuting:{get:()=>r.length-r.groupsDone},groupsWaiting:{get:()=>r.length-r.groupsStarted},entries:{get:()=>{var e=[];for(let t of Object.keys(r))r[t].entries.forEach(r=>{r.push(t),e.push(r)});return e}},intercepted:{value:!1,writable:!0}}),r}(u,n.simple);switch(n.emitAs){case\"global\":n.emitAs=t;break;case\"shared\":n.emitAs={};break;case\"status\":n.emitAs=l;break;case\"empty\":Object.defineProperty(n,\"emitAs\",{get:()=>({})});break;default:case\"this\":n.emitAs=this}r=[].concat(r),i.intercept.hasOwnProperty(e)&&(r=i.intercept[e](r),Array.isArray(r)||(l.intercepted=!0,c(e,l)));var h=this,p=new Promise((async function(t){try{i.emitted[e]=r;var o,s,a,p=l.groups.slice(-1);for(o of l.groups){var f=u[o].map((async function(t,u){try{l[o][u]=\"executing\",c(e,l,o,u),!0===t.o&&h.removeListener(t),a=\"string\"==typeof t.e?r:s||(s=[e].concat(r));let i=await t.l.apply(n.emitAs,a);l.results.push([!0,i,o,u]),\"off\"==i&&h.removeListener(t)}catch(r){i.onerror(\"Listener failed.\",{evt:e,listener:t,_args:a},r),l.results.push([!1,r,o,u])}l[o][u]=\"finished\",c(e,l,o,u)})),g=Promise.all(f);if(i.options.groupTimeout&&o!=p)try{let e=new Promise((e,t)=>{setTimeout(t,i.options.groupTimeout)});await Promise.all([g,e])}catch(e){i.onerror(`Group ${o} timed out, triggering next group...`)}else await g}}catch(e){console.error(\"BUGBUG BetterEvents.emitEvent():\",e)}return t(l.results)}));return n.simple?p:(Object.defineProperty(l,\"promise\",{value:p}),l)},n.prototype.emitEvents=function(e,t,r){if(!e instanceof RegExp)throw new TypeError(o(1,\"r_evt\",evt));var n=this;return new Promise((function(i){var o=n.getEvents(e).map(e=>n.emitEvent(e,t,r).promise);Promise.all(o).then(()=>i())})).catch(e=>{n._betterEvents.onerror(\"BUGBUG BetterEvents.emitEvents():\",e)})},n.prototype.emit=function(e,...t){if(e instanceof RegExp)return this.emitEvents(e,t);if(\"string\"==typeof e)return this.emitEvent(e,t).promise;throw new TypeError(o(1,\"evt\",e))},n.prototype.emitOnce=function(...e){return this.alreadyEmitted(e[0])?Promise.resolve():this.emit.apply(this,e)},n.prototype.bufferEvent=function(e,...t){if(\"string\"!=typeof e)throw new TypeError(o(1,\"s_evt\",e));var r=this._betterEvents;if(r.buffer[e]=t,!r.delayTimeout){var n=Date.now();r.delayTimeout=setTimeout(()=>{var e=Date.now()-n;e-r.options.bufferDelay>Math.min(.1*r.options.bufferDelay,100)&&console.warn(\"WARNING: Delayed event slow. Expected \"+r.options.bufferDelay+\" ms, actual \"+e+\" ms\");var t=r.buffer;r.buffer={},r.delayTimeout=null;for(let e in t)this.emitEvent(e,t[e]);this.emit(\"_buffer\",t)},r.options.bufferDelay)}}}(\"undefined\"!=typeof window?window:this||{})},function(e,t,r){\n/**\n* @module bu-browser\n* @author plundell\n* @license MIT\n* @description Helper and utility functions for browsers\n*\n* This script should be bundled for the web with browserify or webpack\n*/\ne.exports=function(e){const t=r(5)(e),n=t.log;n.rename(\"BetterUtil\");const i=r(17)({cX:t,log:n}),o=r(18)({cX:t,log:n,elemX:i}),s=r(19)({cX:t,log:n,elemX:i}),a=r(20)({cX:t,log:n});return Object.assign(t,i,o,s,a),e.BetterUtil=t,t}},function(e,t,r){\"use strict\";\n/**\n* @module bu-common\n* @author plundell\n* @description General purpose javascript utilities and helpers\n* @license MIT\n*\n* This file is meant to be 'required'. It in turn requires all util files in the 'common' folder \n* and re-exports them as one object.\n*\n* This module is required by bu-node and bu-browser which are probably the entry points you'll\n* want to use. \n*/e.exports=function(e){function t(e){throw new Error(\"BetterUtil is missing a dependency: \"+e)}const n=e.BetterLog||t(\"BetterLog\"),i=e.BetterEvents||t(\"BetterEvents\");var{varType:o,logVar:s}=n;if(\"function\"!=typeof o||\"function\"!=typeof s)throw console.error({varType:[typeof o,o],logVar:[typeof s,s],BetterLog:[typeof n,n]}),new Error(\"BUGBUG: The BetterLog constructor didn't have prop-funcs varType and logVar\");const a=new n(\"cX\"),c=r(6)({varType:o,logVar:s,log:a}),u=r(7)({vX:c,log:a}),l=r(8)({vX:c,log:a}),h=r(9)({vX:c,log:a}),p=r(10)({vX:c,log:a}),f=r(11)({vX:c,log:a}),g=r(12)({vX:c,log:a,stX:f}),d=r(13)({vX:c,log:a}),y=r(14),m=r(15)({netmask:y});r(16)({BetterLog:n,BetterEvents:i});return Object.assign({validate:m,log:a,netmask:y},c,u,l,h,p,f,g,d)}},function(e,t){e.exports=function({varType:e,logVar:t,_log:r}){var n={varType:e,logVar:t,checkType:o,checkTypes:function(n,i,s){\"array\"!=e(n)&&r.throwType(\"arg #1 to be an array\",n);switch(e(i)){case\"object\":i=Object.values(i);case\"array\":i=[].concat(i);break;default:r.throw(\"BUGBUG: checkTypes() expected arg#2 to be an array, got:\",t(i))}var a=n.length-i.length;a>0?i.push.apply(i,new Array(a)):a<0&&i.splice(n.length,Math.abs(a));try{var c,u=[];for(c=0;c<n.length;c++)u.push(o(n[c],i[c],!1));return u}catch(e){if(!0===s)return!1;try{var l=r.makeError(e);l.msg=(\"string\"==typeof s?s+\"() a\":\"A\")+\"rg #\"+(c+1)+\": \"+l.msg,l.changeWhere(1)}catch(t){console.error(\"BUGBUG checkTypes(): something was wrong with <BetterLogEntry>:\",t,typeof l,l),console.error(e)}throw l}},checkProps:function(e,n,i){o(\"object\",n,!0)||r.makeError(\"BUGBUG: checkProps expects arg#2 to be an object, got:\",n).throw(\"TypeError\");try{var s;for(s in o(\"object\",e),n)try{n[s]=o(n[s],e[s],!1)}catch(n){if(!0===i)return!1;var a=` prop '${s}'`;a=e.hasOwnProperty(s)?\"Bad\"+a+\": \"+t(e[s]):\"Missing\"+a,i&&(a=i+\"(): \"+a),r.makeError(a,n).throw()}return n}catch(e){e.changeWhere(1).throw()}},isEmpty:function(t,...r){switch(e(t)){case\"nodelist\":case\"array\":return!t.length;case\"object\":return!Object.keys(t).length;case\"undefined\":return!0;case\"string\":return!(t&&!t.match(/^\\s*$/));case\"boolean\":case\"number\":case\"null\":return!t&&!(!r.includes(\"*\")&&!r.includes(t));default:return!t}},sameValue:function t(r,n){if(typeof r!=typeof n)return!1;if(r===n)return!0;if(null===r||null===n)return!1;switch(e(r)){case\"number\":case\"string\":case\"boolean\":case\"node\":case\"function\":case\"undefined\":return!1;case\"array\":return r.length==n.length&&f(r)==f(n);case\"object\":var i=Object.keys(r),o=Object.keys(n);return i.length==o.length&&(i.sort(),o.sort(),!!t(i,o)&&i.every(e=>r[e]===n[e]));case\"nodelist\":if(r.length!=n.length)return!1;for(let e=r.length-1;e>=0;e--)if(r[e]!=n[e])return!1;return!0}},compare:s,getCompareFunc:a,isPrimitive:c,allPrimitive:function(t){if(c(t))return!0;switch(e(t)){case\"object\":t=Object.values(t);case\"array\":return t.every(c);default:return!1}},stringToPrimitive:u,stringToNumber:l,forceType:function(r,n){o(\"string\",r);var i=e(n);switch(r){case i:return n;case\"undefined\":case\"null\":if(\"string\"==typeof n&&n==r)return\"null\"==n?null:void 0;if(empty(n))return\"null\"==r?null:void 0;break;case\"boolean\":switch(n){case\"true\":case\"TRUE\":return!0;case\"false\":case\"FALSE\":return!1;default:return!!n}case\"number\":var s=Number(n);if(!isNaN(s))return s;case\"string\":return\"array\"==i||\"object\"==i?p(n):String(n);case\"array\":if(\"object\"==i){if(Object.keys(n).every(Number.isInteger))return Object.values(n);break}case\"object\":let t=h(n);if(e(t)==r)return t;break;case\"promise\":return Promise.resolve(n);case\"error\":return new Error(String(n));case\"function\":throw new Error(\"Cannot force \"+i+\" to be a function, noone can...\");default:throw new Error(\"Arg #1 should be a return value of helper.varType(), got: \"+r)}throw new TypeError(\"Expected \"+r+\", got \"+t(n))},tryJsonParse:h,tryJsonStringify:p,stringifySafe:f,copy:function(t){switch(e(t)){case\"object\":case\"array\":return JSON.parse(JSON.stringify(t));case\"node\":return t.cloneNode(!0);case\"nodelist\":return Array.from(t,e=>e.cloneNode(!0));default:return t}},instanceOf:function(e,r,n){try{o([\"function\",\"object\"],e)}catch(r){throw new TypeError(\"BUGBUG instanceOf() expected arg #1 to be a constructor or object, got: \"+t(e))}if(o(\"object\",r),r instanceof e)return r.constructor;if(n)return!1;var i=\"function\"==typeof e?e.name:e.constructor.name;throw new TypeError(\"Expected instance of \"+i+\", got: \"+r.constructor.name)}},i={bool:\"boolean\",arr:\"array\",obj:\"object\",str:\"string\",nr:\"number\",\"*\":\"any\",mixed:\"any\"};function o(n,s,a=!1){if(typeof s==n)return n;var u=e(s);switch(e(n)){case\"string\":if(u==(n=i[n]||n)||\"any\"==n)return u;if(\"primitive\"==n){if(c(s))return u}else if(\"<\"==n.substring(0,1)&&\"object\"==u)for(var l=n.substring(1,n.length-1),h=s,p=[];;){if(h.constructor.name==l)return n;if(p.push(h),!(h=h.__proto__).__proto__||h.constructor==h.__proto__.constructor)break}break;case\"array\":var f=n.find(e=>o(e,s,!0));if(f)return f;break;case\"object\":case\"function\":try{if(s instanceof n)return n.constructor.name;break}catch(e){r.error(e)}default:r.throw(\"BUGBUG: checkType() expected arg#1 to be string/array/object/function, got:\",t(n))}if(!0===a)return!1;{let e=r.makeTypeError(n,s).setOptions({printFunc:!0}).changeWhere(1);e.func=a,e.throw()}}function s(e,t,r,n){return a(t)(e,r,n)}function a(e){switch(e){case\"undefined\":case void 0:case\"===\":return(e,t)=>e===t;case\"==\":return(e,t)=>e==t;case\"!=\":case\"!\":return(e,t)=>e!=t;case\"!==\":return(e,t)=>e!==t;case\"<\":return(e,t)=>e<t;case\">\":return(e,t)=>e>t;case\"<=\":return(e,t)=>e<=t;case\">=\":return(e,t)=>e>=t;case\"in\":return(e,t)=>(Array.isArray(t)?t:[t]).includes(e);case\"between\":return(e,t,r)=>\"number\"==typeof e&&e>=t&&e<=r;case\"startsWith\":return(e,t)=>\"string\"==typeof e&&e.startsWith(t);case\"endsWith\":return(e,t)=>\"string\"==typeof e&&e.endsWith(t);case\"contains\":return(e,t)=>\"string\"==typeof e&&e.indexOf(t)>-1;case\"regexp\":return(e,t)=>\"string\"==typeof e&&e.search(t)>-1;default:throw new Error(\"Unknown operator: \"+t(e))}}function c(e){if(null===e)return!0;switch(typeof e){case\"string\":case\"number\":case\"boolean\":return!0}return!1}function u(e){if(\"string\"!=typeof e)return c(e)||cX.makeTypeError(\"string or primitive\",e).throw(),e;switch(e){case\"true\":return!0;case\"false\":return!1;case\"null\":return null;case\"undefined\":return;case\"\":return\"\"}let t=l(e,!0);return void 0===t?e:t}function l(e,t=!1){switch(typeof e){case\"number\":return e;case\"string\":let r=Number(e);if(\"number\"==typeof r&&!isNaN(r))return r;default:if(t)return;throw new Error(\"Bad value, expected a numerical string with an optional sign, got: \"+vX.logVar(e))}}function h(e,t=!1){if(\"object\"==typeof e)return e;try{return JSON.parse(e)}catch(e){}if(\"string\"==typeof e){var n=(o(\"string\",s=e),s.replace(g,\"\"));if(n!=e)return h(n);if(e.includes(\":\")){let t=e.substr(0,1)+e.substr(-1);if(\"{}\"==t||\"[]\"==t)var i=r.makeEntry(\"warn\",\"This is probably a poorly formated JSON string:\",e).exec()}}var s;return!t||e&&\"object\"==typeof e?e:void(i||r.debug(\"Not a JSON string: \",e))}function p(e){try{return JSON.parse(e),e}catch(t){try{return JSON.stringify(e)||\"\"}catch(e){return\"\"}}}function f(t){try{return JSON.stringify(t)}catch(i){if(i.message.indexOf(\"circular structure\")>-1)try{var n=\"\";throw Object.entries(t).forEach(([t,r])=>{switch(n+=t+\":\",e(r)){case\"number\":case\"string\":n+=r;break;default:n+=Object.prototype.toString.call(r)}n+=\",\"}),\"Failed to stringify (circular structure):\"+(n=\"array\"==e(t)?\"[\"+n+\"]\":\"{\"+n+\"}\")}catch(e){i=e}return r.error(i),`<err:${i.message}>`}}s.operators=[\"===\",\"==\",\"!=\",\"!\",\"!==\",\"<\",\">\",\"<=\",\">=\",\"in\",\"between\",\"startsWith\",\"endsWith\",\"contains\",\"regexp\"],s.isOperator=e=>s.operators.includes(e),s.startsWithOperator=e=>{if(\"string\"==typeof e)return s.operators.find(t=>0==e.indexOf(t))},s.splitOnOperator=e=>{let t=s.startsWithOperator(e);return t?[t,u(e.substr(t.length))]:[void 0,e]};var g=new RegExp(/((?:(?:^\\h*)?(?:\\/\\*[^*]*\\*+(?:[^\\/*][^*]*\\*+)*\\/(?:\\h*\\n(?=\\h*(?:\\n|\\/\\*|\\/\\/)))?|\\/\\/(?:[^\\\\]|\\\\\\n?)*?(?:\\n(?=\\h*(?:\\n|\\/\\*|\\/\\/))|(?=\\n))))+)|(\"(?:\\\\[\\S\\s]|[^\"\\\\])*\"|'(?:\\\\[\\S\\s]|[^'\\\\])*'|[\\S\\s][^\\/\"'\\\\\\s]*)/gm);return n}},function(e,t){e.exports=function({_log:e,vX:t}){function r(e,t){let r=e.indexOf(t);return r>-1?e.splice(r,1)[0]:void 0}function n(e,r,...n){n.includes(\"noCheck\")||t.checkTypes([\"array\",\"array\"],[e,r]);var i,o=[],s=[],a=[];for(i of e)r.indexOf(i)>-1?a.push(i):o.push(i);for(i of r)-1==e.indexOf(i)&&s.push(i);return[o,s,a]}return{join:function(r,n,i){try{t.checkType(\"array\",r);var o=\"string\"==typeof i?i+r.splice(-1,1):\"\";return r.join(n)+o}catch(t){e.throw(t)}},uniqueArrayFilter:function(e,t,r){return r.indexOf(e)===t},extractItem:function(e,n){return t.checkType(\"array\",e),r(e,n)},extractItems:function(e,n){if(\"function\"==t.checkTypes([\"array\",[\"array\",\"function\"]],Object.values(arguments))[1]){var i,o=[];for(i=e.length-1;i>-1;i--)n(e[i],i,e)&&o.unshift(e.splice(i,1)[0]);return o}return n.map(t=>r(e,t)).filter(e=>void 0!==e)},flatten:function(e){var t=[];return e.forEach(e=>{Array.isArray(e)?t=t.concat(e):t.push(e)}),t},rowsToString:function(e){var t,r=[],n={};e.forEach(e=>{var i={};for(t in e){switch(e[t]){case void 0:i[t]=\"<undef>\";break;case null:i[t]=\"<null>\";break;default:i[t]=String(e[t])}let r=i[t].length;n[t]?n[t]<r&&(n[t]=r):n[t]=Math.max(String(t).length,r)}r.push(i)});var i=\"\";for(t in n)i+=String(t).padEnd(n[t]+2);return i+=\"\\n\",r.forEach(e=>{for(t in n){let r=e[t]||\"<undef>\";i+=r.padEnd(n[t]+2)}i+=\"\\n\"}),i},getFirstOfType:function(r,n,i=!1){\"object\"==t.checkType([\"array\",\"object\"],r)&&(\"number\"!=typeof r.length?e.throwType(\"arg #1 to be an array-like object\",r):r=Array.from(r));var o=0,s=r.length;for(;o<s;o++){let e=r[o];if(t.checkType(n,e,!0))return i&&r.splice(o,1),e}return},arrayDiff:n,sameArrayContents:function(e,r){if(t.checkTypes([\"array\",\"array\"],[e,r]),e.length!=r.length)return!1;var[i,o,s]=n(e,r,\"noCheck\");return 0==i.length&&0==o.length},anyArrayOverlap:function(e,t){var r;for(r of e)if(t.indexOf(r)>-1)return!0;return!1},pushToNestedArray:function(e,t,r){e.hasOwnProperty(t)||(e[t]=[]);e[t].push(r)},filterSplit:function(e,t,r=!1){try{e.length;var n,i=[],o=[];if(r)for(n=e.length-1;n>=0;n--)t(e[n])?i[n]=e[n]:o[n]=e[n];else for(n=e.length-1;n>=0;n--)t(e[n])?i.unshift(e[n]):o.unshift(e[n]);return Object.defineProperty(i,\"rest\",{value:o,writable:!0,configurable:!0}),i}catch(e){cX.checkTypes([\"array\",\"function\"],arguments),cX._log.makeError(e).throw()}}}}},function(e,t,r){\"use strict\";e.exports=function({_log:e,vX:t}){function r(t,r=!1){try{var n=t.toString();if(\"function () { [native code] }\"==n){if(!t.length)return[];throw\"Because passed function was native or bound.\"}if(n=n.slice(n.indexOf(\"(\")+1,n.indexOf(\")\"))){var i=n.split(\",\").map(e=>e.trim());return r?i:i.map(e=>e.replace(/(.+)=.+/,\"$1\").trim())}return[]}catch(t){e.makeError(t).prepend(\"Could not get argument names.\").throw()}}function n(e,r){t.checkTypes([\"function\",\"string\"],arguments),Object.defineProperty(e,\"name\",{value:r,writable:!1,configurable:!0})}return{prettyArgs:function(e){retObj=Object();var t=JSON.parse(JSON.stringify(e));if(argNames=r(arguments.callee.caller))for(i in t)retObj[argNames[i]]=t[i];return retObj},getArgNames:r,callWithNamedArgs:function(e,n,i){return t.checkTypes([\"function\",\"object\",[\"object\",\"undefined\"]],[e,n,i]),e.apply(i,r(e).map(e=>n[e]))},once:function(e,r){function i(...t){if(i.hasOwnProperty(\"_once\")){if(r)return r(...i._once,t)}else{try{var n=e(...t)}catch(e){var o=e}Object.defineProperty(i,\"_once\",{configurable:!0,value:[o,n]})}if(o)throw o;return n}t.checkTypes([\"function\",[\"function\",\"undefined\"]],arguments),e.name&&n(i,e.name+\"_once\");return i},renameFunction:n,betterTimeout:function(...e){var r,n,i,o=cX.getFirstOfType(e,\"number\"),s=cX.getFirstOfType(e,\"function\"),a=cX.getFirstOfType(e,\"object\");t.checkTypes([\"function\",\"number\"],s,o);var c={};Object.defineProperties(c,{callback:{get:()=>s},delay:{get:()=>o,set:e=>{\"number\"==typeof e&&(o=e)}},result:{get:()=>n},ignored:{get:()=>r?i:void 0}}),c.execute=function(e,t){if(!t){if(!i)return;t=i[1],e=i[0]}return n=s.apply(a||e,t),i=void 0,c},c.clear=function(){return r&&(clearTimeout(r),r=void 0),c},c.trigger=function(){return r||(i=[this,arguments],r=setTimeout(()=>{clear().execute(this,arguments)},o)),c},c.block=function(){return r||(r=setTimeout(clear,o),execute(this,arguments)),c},c.debounce=function(){return clear().trigger.apply(this,arguments)},c.throttle=function(){return r?i=[this,arguments]:(r=setTimeout(()=>{r=void 0,execute()},o),apply(this,arguments)),c},c.postpone=function(){return r&&(clear(),i&&trigger.apply(i[0],i[1])),c},c.expire=function(){return r&&clear().execute(),c}}}}},function(e,t,r){\"use strict\";e.exports=function({_log:e,vX:t}){function r(e,r,n=null,i=null){if(t.checkTypes([\"array\",\"array\"],[e,r]),e.length!=r.length)throw new Error(\"Expected both arrays to be same length, they were \"+e.length+\" and \"+r.length);\"function\"!=typeof n&&(n=e=>e),\"function\"!=typeof i&&(i=e=>e);var o={};for(let t in e)o[n(e[t])]=i(r[t]);return o}function n(e,n,i){return t.checkType(\"object\",e),r(Object.keys(e),Object.values(e),n,i)}function i(e,r=\".\"){t.checkTypes([\"object\",\"string\"],[e,r]);var n={},i=[],o=e=>{Object.entries(e).forEach(([e,s])=>{t.isPrimitive(s)?n[i.concat(e).join(r)]=s:(i.push(e),o(s),i.pop())})};return o(e),n}function o(e,r,n=!1){var i=t.checkTypes([[\"array\",\"object\"],[\"string\",\"number\",\"array\",\"function\"]],[e,r]);if(\"function\"==i[1])r=Object.entries(e).filter(e=>r(e[0],e[1])).map(e=>e[0]),n=!1;else if(\"array\"!=i[1])return e[r];var o={};return n?r.forEach(t=>{e.hasOwnProperty(t)&&(o[t]=e[t])}):r.forEach(t=>o[t]=e[t]),o}function s(e,t,r){var n=o(e,t,r);return Array.isArray(t)||\"function\"==typeof t?Object.keys(n).forEach(t=>delete e[t]):delete e[t],n}function a(r,n,i=!1){t.checkTypes([[\"object\",\"array\"],\"array\"],[r,n]);for(var o=r,s=[];n.length;){if(\"object\"!=typeof o)e.throw(`Cannot get nested value, non-object @ ${s.join(\".\")}:`,o,r);else if(!o.hasOwnProperty(n[0]))return i?o:void 0;o=o[n[0]],s.push(n.shift())}return o}function c(r,n,i,o=!1){t.checkType(\"array\",n);var s=n.pop();s||e.throw(\"No keys specified, cannot set value on object: \",i,r);var c=t.copy(n),u=a(r,n,!0);let l=c.splice(-n.length).join();if(o)for(var h;h=n.shift();)u[h]={},u=u[h];else n.length&&e.makeError(`Not creating @ '${l}':`,r).throw();return\"object\"!=typeof u&&e.throw(`Not an object @ '${l}':`,r),u[s]=i}return{objCreateFill:function(e,r,n=!1){t.checkType(\"array\",e);var i={};for(let o of e)i[o]=n?t.copy(r):r;return i},combineKeysValues:r,recombineKeysValues:n,addUniqueItemToNestedArr:function(e,t,r){if(e.hasOwnProperty(t)){if(!Array.isArray(e[t]))throw new TypeError(\"Expected prop (\"+t+\") to be array, was:\"+typeof e[t]);e[t].includes(r)||e[t].push(r)}else e[t]=[r];return},combineUniqueNestedArrays:function(t,r){for(let n of Object.keys(t)){let i=\"array\"==typeof t[n]?t[n]:[t[n]];r.hasOwnProperty(n)?Array.isArray(r[n])?e.throwType(`nested key ${n} to be array`,r[n]):i.forEach(e=>{r[n].includes(e)||r[n].push(e)}):r[n]=i}return},splitArrayItemsToObject:function(r,n){\"object\"==t.checkTypes([\"array\",[\"string\",\"object\"]],[r,n])[1]&&t.instanceOf(RegExp,n);var i={},o=!0;return r.forEach((r,s)=>{try{t.checkType(\"string\",r);var[a,...c]=r.split(n);i[a]=c.join(n)}catch(t){o&&(o=!1,e.warn(\"Error parsing array for key-value pairs\")),e.warn(\"   item \"+s+\": \"+t.message)}}),i},indentStringToObject:function(e){var t={},r=0,n=[t],i=t;return e.split(\"\\n\").forEach(e=>{let t=e.match(/^(\\s*)(.+)$/);if(!t)return;let o=t[1].length;o>r?n.unshift(i):o<r&&n.shift(),r=o,i={},n[0][t[2].trim()]=i}),t},objectToLines:function(e,t){return Object.entries(e).map(([e,r])=>e+t+r).join(\"\\n\")},flattenObject:i,hasOwnProperties:function e(r,n,i=\"any\"){switch(t.checkTypes([\"object\",\"array\",\"string\"],[r,n,i]),i){case\"any\":for(var o=0;o<n.length;o++)if(r.hasOwnProperty(n[o]))return!0;return!1;case\"all\":for(o=0;o<n.length;o++)if(!r.hasOwnProperty(n[o]))return!1;return!0;case\"noother\":return Object.keys(r).every(e=>n.includes(e));case\"exact\":return e(r,n,\"noother\")&&e(r,n,\"all\");case\"array\":var s=[];for(o=0;o<n.length;o++)r.hasOwnProperty(n[o])&&s.push(n[o]);return s.length?s:null;case\"object\":for(s={},o=0;o<n.length;o++)r.hasOwnProperty(n[o])&&(s[n[o]]=r[n[o]]);return Object.keys(s).length?s:null;default:throw new Error(\"Unrecognized mode: \"+i)}},keysToLower:function(e){return n(e,e=>e.toLowerCase())},subObj:o,extract:s,emptyObject:function(e){return s(e,Object.keys(e))},getFirstMatchingProp:function(e,r,n=null,i=!1){n?t.checkType([\"function\",\"null\"],n):n=e=>!!e;e=i?s(e,r,!0):o(e,r,!0);return Object.values(e).find(n)},nestedGet:a,nestedSet:c,nestedAssign:function(e,r){t.checkTypes([\"object\",\"object\"],arguments);var n=\"<&@%>\",o=i(r,n);return Object.entries(o).forEach(([t,r])=>c(e,t.split(n),r,\"create\")),e},getChildProps:function(e,r,n){var i={};\"string\"==t.checkTypes([[\"object\",\"array\"],[\"string\",\"array\"]],[e,r])[1]?Object.entries(e).forEach(([e,t])=>{t.hasOwnProperty(r)?i[e]=t[r]:null!=n&&(i[e]=n)}):Object.entries(e).forEach(([e,t])=>{try{var o=a(t,r)}catch(e){o=void 0}null==o&&null==n||(i[e]=o)});return i},groupChildrenByProp:function(e,r,...n){t.checkTypes([[\"object\",\"array\"],\"string\"],[e,r]);var i=\"undefined\",o=!1;n.forEach((e,t)=>{switch(typeof e){case\"boolean\":o=e;break;case\"number\":case\"string\":\"extract\"==e?o=!0:i=e;break;default:log.makeError(`Arg #${t+2} can be string/number/boolean, got:`,e).throw(\"TypeError\")}});var s={};return Object.entries(e).forEach(([e,t])=>{var n=t[r]||i;n=\"number\"==typeof n?n:String(n),s[n]=s[n]||{},s[n][e]=t,o&&delete t[r]}),s},groupKeysByValue:function(e){t.checkType([\"object\",\"array\"],e);var r,n={};for(r in e)n.hasOwnProperty(r)||(n[r]=[]),n[r].push(e[r])},argObjToArr:function(e){var t,r=[];for(t in e)r.push(t),r.push(e[t]);return r},nestedObjToArr:function(e,t=\"id\"){var r,n=[];for(r in e){let i={};i[t]=r,n.push(Object.assign(i,e[r]))}return n},forEachNestedPrimitive:function(e,r){return t.checkType([\"object\",\"array\"],e),function e(n){for(let i in n)t.checkType([\"object\",\"array\"],n[i],!0)?e(n[i]):r(n,i)}(e),e},objToQueryStr:function(e){t.checkType(\"object\",e);var r,n,i=[];for(r in e)n=e[r],Array.isArray(n)&&t.allPrimitive(n)&&(r+=\"[]\",n=n.join(\",\")),\"object\"==typeof n&&(n=JSON.stringify(e)),t.isEmpty(n,null)&&(n=\"\"),i.push(r+\"=\"+encodeURIComponent(n));return i.join(\"&\")}}}},function(e,t,r){\"use strict\";e.exports=function({_log:e,vX:t}){function r(t,r,n=null){return n&&n instanceof e&&n.debug(\"Going to sleep for \"+t+\" ms...\"),new Promise(i=>{setTimeout(()=>{n&&n instanceof e&&n.debug(\"...waking up\"),i(r)},t)})}function n(e){return e instanceof Promise?e:\"function\"==typeof e?i(e):Promise.resolve(e)}function i(r,n,i){try{return t.checkType(\"function\",r),\"array\"!=t.varType(n)&&(n=[n]),t.checkType([\"object\",\"null\",\"undefined\"],i),new Promise((async function(e,t){try{e(await r.apply(i,n))}catch(e){t(e)}}))}catch(t){return e.reject(\"Failed to wrap function in promise.\",t)}}function o(e,r,n){t.checkTypes([\"function\",\"function\",\"number\"],[e,r,n]);let i=setTimeout(()=>{r(\"timeout\")},n);return{resolve:function(t){clearTimeout(i),e(t)},reject:function(e){clearTimeout(i),r(e)},clear:()=>{clearTimeout(i)}}}function s(e=null){var t={inspect:{status:\"pending\",result:void 0,done:!1}},r=new Promise((e,r)=>{t.resolve=e,t.reject=r});return t.promise=r.then(e=>(t.inspect.done=!0,t.inspect.status=\"resolved\",t.inspect.result=e,e),e=>(t.inspect.done=!0,t.inspect.status=\"rejected\",t.inspect.result=e,Promise.reject(e))),\"number\"==typeof e&&Object.assign(t,o(t.resolve,t.reject,e)),t.callback=function(e,r){return e?t.reject(e):t.resolve(r)},t}return{sleep:r,toPromise:n,callInPromise:i,wrapFuncInPromise:function(e,r){return t.checkType(\"function\",e),function(...t){try{Promise.resolve(e.apply(r||this||null,t))}catch(e){return Promise.reject(e)}}},awaitAllPromises:function(i,o=[]){e.makeEntry(\"note\",\"TODO: replace call to awaitAllPromises() with groupPromises()\").changeWhere(1).highlight(\"blue\"),t.checkTypes([\"array\",\"array\"],[i,o]);var s=!1,a={resolved:[],rejected:[],all:[],remaining:i.length,promises:i.map(n),err:null,awaitAllPromises:null},c=a.promises.map(e=>e.then(e=>[!0,e],e=>(s=!0,[!1,e])).then(e=>(a.remaining-=1,e)));a.awaitAllPromises=Promise.all(c).then(t=>{try{if(o.indexOf(\"flatten\")>-1){var r=[];t.forEach(([e,t])=>{switch(t.__awaitAllPromises__){case\"mixed_array\":r=r.concat(t);case\"object\":r=r.concat(t.rejected.map(e=>[!1,e])),t=t.resolved;case\"resolved_array\":r=r.concat(t.map(e=>[!0,e]));break;case void 0:default:r.push([e,t])}}),t=r}if(a.all=t,t.forEach(([e,t],r)=>{1==e?a.resolved[r]=t:a.rejected[r]=t}),a.rejected.length&&!a.err&&(a.err=\"The following promises rejected: \"+Object.keys(a.rejected).join(\",\")),Object.defineProperty(a.resolved,\"__awaitAllPromises__\",{value:\"resolved_array\"}),Object.defineProperty(a,\"__awaitAllPromises__\",{value:\"object\"}),Object.defineProperty(t,\"__awaitAllPromises__\",{value:\"mixed_array\"}),o.indexOf(\"logRejected\")>-1){var n=a.promises.length;a.rejected.forEach((t,r)=>e.makeError(t).addHandling(`This was promise ${r+1} of ${n} passed to awaitAllPromises().`).exec())}return o.indexOf(\"array\")>-1?s?Promise.reject(t):Promise.resolve(t):o.includes(\"alwaysResolve\")?Promise.resolve(a):o.indexOf(\"onlyResolved\")>-1||!s?Promise.resolve(a.resolved):Promise.reject(a)}catch(t){return e.error(\"BUGBUG awaitAllPromises():\",t),Promise.reject(a)}});var u=o.indexOf(\"timeout\"),l=o[u+1];return u>-1&&\"number\"==typeof l?Promise.race([a.awaitAllPromises,r(l).then(()=>(a.err=\"timeout\",Promise.reject(a)))]):a.awaitAllPromises},firstResolved:function(e,r=!1){var i=(new Error).stack;return new Promise((function(o,s){t.checkTypes([\"array\",\"boolean\"],[e,r]);let a=e.length,c=[];var u=0,l=!1;e.map(e=>n(e).then(e=>{l?r&&log.note(\"More than one promise resolved:\",e):(l=!0,o(e))},e=>{r?log.error(e):l||c.push(e),++u>=a&&!l&&s(log.makeError(`All ${a} promises rejected.`,r?\"See previous logs\":c).setStack(i))}))}))},InspectablePromise:function(e){this.status=\"pending\",this.result=void 0;var{promsie:t,resolve:r,reject:n}=s(),i={resolvedHandler:null,rejectHandler:null};e.then(e=>{\"pending\"==this.status&&(this.status=\"resolved\",this.result=e,\"function\"==typeof i.resolveHandler&&r(i.resolveHandler(e)))},e=>{\"pending\"==this.status&&(this.status=\"rejected\",this.result=e,\"function\"==typeof i.rejectHandler&&r(i.rejectHandler(e)))}),this.then=(e,o)=>{switch(this.status){case\"pending\":i.resolveHandler=e,i.rejectHandler=o;break;case\"resolved\":\"function\"==typeof e&&r(e(this.result));case\"timeout\":case\"rejected\":return\"function\"==typeof o?r(o(this.result)):n(this.result)}return t},this.catch=e=>(\"function\"==typeof e&&(\"rejected\"==this.status?r(e(this.result)):i.rejectHandler=e),t)},promiseTimeout:function(t,i=1,o=\"timeout\"){return t=n(t),Promise.race([t,r(i).then(()=>3==arguments.length?(t.catch(e.error),Promise.reject(o)):Promise.reject(t))])},rejectTimeout:o,exposedPromise:s,groupPromises:function(e,...r){t.checkTypes([\"array\"],[e]);var i,o,s=r.length-1;for(;s>=0;s--){let e=r[s];e&&\"object\"==typeof e&&(\"BetterLog\"==e.constructor.name?i=e:\"function\"==typeof e.emit&&(o=e))}var a={resolved:[],rejected:[],all:[],promises:e=e.map(n),err:null};Object.defineProperty(a,\"remaining\",{enumerable:!0,get:()=>a.promises.length-Object.keys(a.all).length});let c=a.promises.length;var u=a.promises.map((e,t)=>e.then(e=>{a.resolved[t]=e,a.all[t]=[!0,e],i&&i.trace(`Promise #${t} resolved (${a.remaining} remaining) with:`,e),o&&o.emit(\"resolve\",e,t)},e=>{a.rejected[t]=e,a.all[t]=[!1,e],i&&i.makeError(e).addHandling(`Promise ${t+1} rejected (${a.remaining} remaining)`).exec(),o&&o.emit(\"reject\",e,t);var r=`${Object.keys(a.rejected).length} of ${c} promises rejected`;a.remaining&&(r+=`, ${a.remaining} remaining`),a.err=r}).then((function(){a.remaining<1&&i&&(i.trace(\"All grouped promises have finished\"),o&&o.emit(\"finished\",a))})));return a.promise=Promise.all(u).then(()=>a.err?Promise.reject(a):a),a},thenCallback:function(e,t){return Promise.resolve(e).then(e=>t(null,e),e=>t(e))},promiseAlways:function(e,t){return Promise.resolve(e).then(e=>(t(null,e),e),e=>(t(e),Promise.reject(e)))}}}},function(e,t,r){\"use strict\";e.exports=function({_log:e,vX:t}){function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(e){return e.charAt(0).toLowerCase()+e.slice(1)}function i(e){return t.checkType(\"string\",e),e.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\")}function o(e,r){t.checkTypes([\"string\",\"array\"],arguments);var n,i=[];for(n=0;n<r.length;n++)i.push(e.substring(r[n],r[n+1]).trim());return i}function s(e){var t={},r=0;return e.match(/[^\\s]+(\\s+|$)/g).forEach(e=>{t[r]=e.trim(),r+=e.length}),t}var a={black:[\"30\",\"40\"],red:[\"31\",\"41\"],green:[\"32\",\"42\"],yellow:[\"33\",\"43\"],blue:[\"34\",\"44\"],magenta:[\"35\",\"45\"],cyan:[\"36\",\"46\"],white:[\"37\",\"47\"],brightblack:[\"90\",\"100\"],brightred:[\"91\",\"101\"],brightgreen:[\"92\",\"102\"],brightyellow:[\"93\",\"103\"],brightblue:[\"94\",\"104\"],brightmagenta:[\"95\",\"105\"],brightcyan:[\"96\",\"106\"],brightwhite:[\"97\",\"107\"]};function c(e,t,r){var n;return\"string\"==typeof t&&(t=t.toLowerCase().replace(\" \",\"\"),a.hasOwnProperty(t)&&(e=\"\u001b[\"+(n=a[t][0])+\"m\"+e)),\"string\"==typeof r&&(r=r.toLowerCase().replace(\" \",\"\"),a.hasOwnProperty(r)&&(e=\"\u001b[\"+(n=a[r][1])+\"m\"+e)),n&&(e+=\"\u001b[0m\"),e}function u(e=32,t=\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"){for(var r=\"\",n=e;n>0;--n)r+=t[Math.round(Math.random()*(t.length-1))];return r}return{md5hash:function(e){if(\"undefined\"==typeof CryptoJS)throw new Error(\"Cannot find CryptoJS\");if(\"string\"!=typeof e)throw new TypeError(\"Can only hash strings\");return CryptoJS.MD5(e).toString(CryptoJS.enc.hex)},formatString:function(e,t){if(\"string\"!=typeof t)return\"\";switch(e){case\"firstToUpper\":case\"firstBig\":case\"capitalize\":return r(t);case\"firstToLower\":case\"firstSmall\":return n(t);case\"toLowerCase\":case\"toLower\":case\"lower\":case\"low\":case\"small\":return t.toLowerCase();case\"toUpperCase\":case\"toUpper\":case\"upper\":case\"up\":case\"big\":case\"large\":case\"capitals\":return t.toUpperCase()}return\"\"},firstToUpper:r,firstToLower:n,toLower:function(e,t){return\"string\"==typeof e?e.toLowerCase():t},trim:function(t,r=!1){\"string\"!=typeof t&&e.throwType(\"string\",t);function n(e){return e.trim().replace(/^[\"'\\n]+/,\"\").replace(/[\"'\\n]+$/,\"\").trim()}var i,o=0;for(;t!=(i=n(t));)if(t=i,++o>10){e.warn(\"Exceeded 10 loops when trying to trim string...\");break}if(r&&\"\"==t)throw new Error(\"String was empty\");return t},substring:function(e,r,n){if(t.checkType(\"string\",e),r>e.length)return\"\";r<0&&(r=e.length+r);var i=e.length;\"number\"==typeof n&&Math.min(r+n,e.length);return e.substring(r,i)},replaceAll:function(e,t,r){return e.length<40?e.split(t).join(r):(t=i(t),e.replace(new RegExp(t,\"g\"),r))},escapeRegExp:i,regexpAll:function(r,n,i=0){t.checkTypes([\"<RegExp>\",\"string\"],[r,n]),-1==r.flags.indexOf(\"g\")&&(e.debug(\"Adding 'g' flag to regexp else we cannot get all matches. \"+r),r=new RegExp(r.toString()+\"g\"));var o,s=[],a=0;for(;null!==(o=r.exec(n));){if(a++,i&&i<a){e.warn(`Exceeded max matches (${i}), breaking early.`);break}s.push(o)}return s},limitString:function(e,r){t.checkType(\"string\",e);let n=e.length;if(n>r){var i=Math.round(r/2);return e.substring(0,i)+\" ...\"+(n-r)+\"... \"+e.substring(n-i)}return e},split:function(r,n,i){try{t.checkType(\"string\",r);var o=r.split(n);if(t.checkType([\"array\"],o),i){var s=o.pop();t.checkType([\"string\"],s,!0)&&o.concat(s.split(i))}return o}catch(t){e.throw(t)}},splitAt:o,indexWords:s,linuxTableToObjects:function(t,r=!1,n=!1){\"object\"==typeof t&&t.hasOwnProperty(\"stdout\")&&(t=t.stdout);var i;Array.isArray(t)?i=t:(\"string\"!=typeof t&&(t=t.toString(\"utf8\").trim()),\"string\"!=typeof t&&e.throwType(\"string\",t),i=t.split(\"\\n\"));if(!(i=i.map(e=>e.trim()).filter(e=>e)).length)return[];try{var a=i.splice(0,1)[0];if(n){let e=s(a);n=Object.keys(e),a=Object.values(e)}else a=a.split(/\\s+/);r&&(a=a.map(e=>e.toLowerCase()))}catch(t){e.makeError(\"Failed to convert linux columns to array of objects.\",t).throw()}return i.map(t=>{var r;if(n)r=o(t,n);else if((r=t.split(/\\s+/)).length>a.length){let e=r.splice(a.length-1).join(\" \");r.push(e)}r.length!=a.length&&e.throw(\"Problem converting columns to array of objects. There are \"+`${a.length} headers and ${r.length} values`,log.logVar(a,1e3),log.logVar(r,1e3));var i={};for(let e in a)i[a[e]]=r[e];return i})},wrapInBashColor:c,progressBar:function(e,t=10,r=!1,n=\"x\",i=\".\"){var o=Math.round(e*t),s=t-o;n=n.repeat(o),r&&(n=c(n,r));return\"[\"+n+i.repeat(s)+\"]\"},queryStrToObj:function(r){t.checkType(\"string\",r),(\"#\"==r.substring(0,1)||\"?\"==r.substring(0,1))&&(r=r.substring(1));var n={},i=r.split(\"&\"),o=i.length-1;for(;o>=0;o--)try{var s=i[o].split(\"=\"),a=s[0];if(a){var c=t.stringToPrimitive(s[1]);c&&\"string\"==typeof c&&(c=decodeURIComponent(c)),\"[]\"==a.substring(a.length-2)?(a=a.substring(0,a.length-2),c=t.isEmpty(c)?[]:\"string\"==typeof c?c.split(\",\").map(t.stringToPrimitive):[c]):\"{\"!=c[0]&&\"[\"!=c[0]||(c=t.tryJsonParse(c)),n[a]=c}}catch(t){e.warn(\"Bad pair in uri string:\",i[o],r,t)}return n},dashToCamel:function(e){return e.replace(new RegExp(\"-([a-z])\",\"g\"),(e,t)=>t.toUpperCase())},randomString:u,getUniqueString:function(r,n){if(t.checkTypes([\"string\",\"array\"],arguments),!n.includes(r))return r;var i;for(i=2;i<1e3;i++){let e=r+\"_\"+String(i);if(!n.includes(e))return e}i=10;for(;i--;){let e=r+\"_\"+u(10);if(!n.includes(e))return e}e.throw(\"Could not find unique string\",arguments)}}}},function(e,t,r){\"use strict\";e.exports=function({_log:e,stX:t,vX:r}){function n(t,r=!0,n=!0){var i,o,s={};try{for(i in t){var a=t[i];for(o in Array.isArray(a)||(a=[a]),a)s[o]=i,\"string\"==typeof o&&n&&(s[o.toLowerCase()]=i);\"string\"==typeof i&&n&&(s[i]=i),r&&(s[i]=i)}return Object.defineProperty(s,\"_hasBeenPrepared\",{value:!0}),s}catch(r){e.throwType(\"Unsupported formated map passed to prepareMap():\",t,r)}}return{round:function(e,t=0){return Number(Math.round(e+\"e\"+t)+\"e-\"+t)},getRandomInt:function(e=1e6){return Math.floor(Math.random()*Math.floor(e))},eventTimeout:function(e,t,r,n,i){var o=!1;return e.once(t,()=>o=!0),setTimeout(()=>{0==o&&n(i)},r)},mapping:{prepare:n,apply:function(e,t,i=!1){r.checkTypes([\"object\",\"object\"],[e,t]);var o,s=t._hasBeenPrepared?t:n(t),a={};if(i)for(o in e)s[o]&&(a[s[o]]=e[o]);else for(o in e)a[s[o]]=e[o];return a}},range:function(e,t){return r.checkTypes([\"number\",\"number\"],arguments),[...Array(t+1).keys()].slice(e)}}}},function(e,t,r){\"use strict\";(function(t){e.exports=function({vX:e,_log:r}){var n={BetterDate:function t(n){if(this.constructor!=t)return new t(n);function a(t){return e.checkType(\"string\",t),t=t.substr(0,1).toUpperCase()+t.substr(1),\"function\"==typeof this.date[\"get\"+t]?t:\"s\"==t.substr(-1)?t.slice(0,-1):\"function\"==typeof this.date[\"get\"+t+\"s\"]?t+\"s\":void 0}this.date=o(n&&n.date&&n.date instanceof Date?n.date:n),Object.defineProperties(this,{format:{enumerable:!0,get:()=>s(this.date)},dom:{enumerable:!0,get:()=>this.date.getDate()},dow:{enumerable:!0,get:()=>this.date.getWeek()},month:{enumerable:!0,get:()=>this.date.getMonth()},year:{enumerable:!0,get:()=>this.date.getYear()},hour:{enumerable:!0,get:()=>this.date.getHours()},minute:{enumerable:!0,get:()=>this.date.getMinutes()},time:{enumerable:!0,get:()=>this.date.toTimeString().split(\" \").unshift()},unix:{enumerable:!0,get:()=>this.date.valueOf()}}),this.first={dom:{this:{},last:{},next:{}}},Object.defineProperties(this.first.dom.this,\"week\",{enumerable:!0,get:()=>this.date.getDate()-this.date.getDay()}),Object.defineProperties(this.first.dom.next,\"week\",{enumerable:!0,get:()=>new Date(this.first.dom.this.week+7).getDate()}),Object.defineProperties(this.first.dom.last,\"week\",{enumerable:!0,get:()=>new Date(this.first.dom.this.week-7).getDate()}),this.last={dom:{this:{},last:{},next:{}}},Object.defineProperties(this.last.dom.this,\"week\",{enumerable:!0,get:()=>this.first.dom.this.week+6}),Object.defineProperties(this.last.dom.next,\"week\",{enumerable:!0,get:()=>this.first.dom.next.week+6}),Object.defineProperties(this.last.dom.last,\"week\",{enumerable:!0,get:()=>this.first.dom.last.week+6}),this.copy=()=>new t(this.date),this.compare={time:e=>l(e,this.time),date:e=>{var t=o(e);return t>this.date?1:t<this.date?-1:0}},this.set=(e,t)=>(e=\"set\"+a(e),this.date=new Date(this.date[e](t)),this),this.set.dom=this.set.dayofmonth=this.set.bind(this,\"date\"),this.set.dow=this.set.dayofweek=e=>this.set(\"date\",this.first.dow.this.week+e),this.set.months=this.set.month=this.set.bind(this,\"month\"),this.set.years=this.set.year=this.set.bind(this,\"year\"),this.set.hours=this.set.hour=this.set.bind(this,\"hours\"),this.set.minutes=this.set.minute=this.set.bind(this,\"minutes\"),this.set.time=e=>{\"string\"!=typeof e&&r.makeTypeError(\"string time HH:MM\",e).throw();var t=e.match(/^(\\d{2}):(\\d{2}):?(\\d{2})?$/);t?(this.set.hour(t[1]),this.set.minute(t[2]),this.set.second(t[3]||0)):r.makeError(\"Bad time format. Expected HH:MM, got: \"+e).setCode(\"EINVAL\").throw()},this.goto={},this.goto.upcoming=t=>{var n=t;return\"string\"==e.checkType([\"string\",\"number\"],n)&&(n=i.indexOf(n.toLowerCase())),(n<0||n>6)&&r.makeError(\"Expected a string weekday or number between 0-6, got:\",t).setCode(\"EINVAL\").throw(),this.dow>=n&&this.add.week(1),this.set.dow(n)},this.add=(t,r)=>(e.checkType(\"number\",r),\"Week\"==(t=a(t))?(r*=7,t=\"Date\"):\"Day\"==t&&(t=\"Date\"),this.date=new Date(this.date[\"set\"+t](this.date[\"get\"+t]()+r)),this),this.add.days=this.add.day=this.add.bind(this,\"date\"),this.add.weeks=this.add.week=this.add.bind(this,\"week\"),this.add.months=this.add.month=this.add.bind(this,\"month\"),this.add.years=this.add.year=this.add.bind(this,\"year\"),this.add.hours=this.add.hour=this.add.bind(this,\"hours\"),this.add.minutes=this.add.minute=this.add.bind(this,\"minutes\"),this.sub=(e,t)=>this.add(e,-1*t),this.sub.days=this.sub.day=this.sub.bind(this,\"date\"),this.sub.weeks=this.sub.week=this.sub.bind(this,\"week\"),this.sub.months=this.sub.month=this.sub.bind(this,\"month\"),this.sub.years=this.sub.year=this.sub.bind(this,\"year\"),this.sub.hours=this.sub.hour=this.sub.bind(this,\"hours\"),this.sub.minutes=this.sub.minute=this.sub.bind(this,\"minutes\")},makeDate:o,formatDate:s,formatDatetime:function(e){return o(e).toString().split(\"(\")[0]},today:a,tomorrow:c,todayMs:function(){return Date.parse(a()).getTime()},tomorrowMs:function(){return Date.parse(c()).getTime()},age:function e(t,r=\"best\",n=!1){var i=Date.now()-t;switch(r){case\"best\":return i<1e3?\"now\":i<6e4?String(e(t,\"sec\"))+(n?\" sec\":\" seconds\"):i<36e5?String(e(t,\"m\"))+(n?\" min\":\" minutes\"):i<864e5?String(e(t,\"h\"))+(n?\" hrs\":\" hours\"):String(e(t,\"days\"))+\" days\";case\"ms\":case\"millisec\":case\"millisecond\":case\"milliseconds\":return i;case\"s\":case\"sec\":case\"second\":case\"seconds\":return Math.round(i/1e3,1);case\"m\":case\"min\":case\"minute\":case\"minutes\":return Math.round(i/1e3/60,1);case\"h\":case\"hours\":case\"hour\":return Math.round(i/1e3/60/60,1);case\"d\":case\"days\":case\"day\":return Math.round(i/1e3/60/60/24,1)}},timerStart:function(){return t?t.hrtime():window.performance.now()},timerStop:function(e,r){var n;if(t){let r=t.hrtime(e);n=1e9*r[0]+r[1]}else n=1e6*(window.performance.now()-e);switch(r){case\"s\":case\"sec\":case\"seconds\":return round(n/1e9);case\"ms\":case\"milli\":case\"milliseconds\":return round(n/1e6);case\"us\":case\"micro\":case\"microseconds\":return round(n/1e3);case\"ns\":case\"nano\":case\"nanoseconds\":return n;default:throw new Error(\"Please specify format (arg #2)\")}},timeToDate:u,compareTimes:l},i=[\"sunday\",\"monday\",\"tuesday\",\"wednesday\",\"thursday\",\"friday\",\"saturday\"];function o(e){if(void 0===e)return Date.now();var t=new Date(e);return\"Invalid Date\"==t&&r.makeError(\"Invalid Date:\",r.constructor.logVar(e)).setCode(\"EINVAL\").throw(),t}function s(e){return`${(e=o(e)).getFullYear()}-${String(e.getMonth()+1).padStart(2,\"0\")}-${String(e.getDate()).padStart(2,\"0\")}`}function a(){return s()}function c(){return s(new Date(Date.now()+864e5))}function u(e){return new Date(\"1970-01-01 \"+e)}function l(e,t){return e==t?0:(e=u(e))>(t=u(t))?1:e<t?-1:0}return n}}).call(this,r(0))},function(e,t){var r,n,i;e.exports=(i=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(\".\")},n=function(e){var t,r,n,i,o;if(0===(t=(e+\"\").split(\".\")).length||t.length>4)throw new Error(\"Invalid IP\");for(n=i=0,o=t.length;i<o;n=++i){if(r=t[n],isNaN(parseInt(r,10)))throw new Error(\"Invalid byte: \"+r);if(r<0||r>255)throw new Error(\"Invalid byte: \"+r)}return((t[0]||0)<<24|(t[1]||0)<<16|(t[2]||0)<<8|(t[3]||0))>>>0},r=function(){function e(e,t){var r,o,s;if(\"string\"!=typeof e)throw new Error(\"Missing `net' parameter\");if(t||(s=e.split(\"/\",2),e=s[0],t=s[1]),!t)switch(e.split(\".\").length){case 1:t=8;break;case 2:t=16;break;case 3:t=24;break;case 4:t=32;break;default:throw new Error(\"Invalid net address: \"+e)}if(\"string\"==typeof t&&t.indexOf(\".\")>-1){try{this.maskLong=n(t)}catch(e){throw new Error(\"Invalid mask: \"+t)}for(r=o=32;o>=0;r=--o)if(this.maskLong===4294967295<<32-r>>>0){this.bitmask=r;break}}else{if(!t)throw new Error(\"Invalid mask: empty\");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(n(e)&this.maskLong)>>>0}catch(t){throw new Error(\"Invalid net address: \"+e)}if(!(this.bitmask<=32))throw new Error(\"Invalid mask for ip4: \"+t);this.size=Math.pow(2,32-this.bitmask),this.base=i(this.netLong),this.mask=i(this.maskLong),this.hostmask=i(~this.maskLong),this.first=this.bitmask<=30?i(this.netLong+1):this.base,this.last=this.bitmask<=30?i(this.netLong+this.size-2):i(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?i(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return\"string\"==typeof t&&(t.indexOf(\"/\")>0||4!==t.split(\".\").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(n(t)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(i(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,r,o;for(o=n(this.first),r=n(this.last),t=0;o<=r;)e(i(o),o,t),t++,o++},e.prototype.toString=function(){return this.base+\"/\"+this.bitmask},e}(),{ip2long:n,long2ip:i,Netmask:r})},function(e,t,r){\"use strict\";e.exports=function({netmask:e,vX:t}){return{email:function(e){return e.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/)},ip:function(r,...n){\"string\"!=typeof r&&t._log.makeError(\"Expected a IP string, got:\",this.log.logVar(r)).throw(\"TypeError\");try{try{e.ip2long(r)}catch(e){t._log.makeError(`Not valid IP: ${r}`).throw()}r.includes(\"/\")?n.includes(\"allowSubnet\")||n.includes(\"requireSubnet\")||t._log.makeError(`Got subnet, wanted regular IP: ${r}`).throw():n.includes(\"requireSubnet\")&&t._log.makeError(`Got regular IP, wanted subnet: ${r}`).throw()}catch(e){if(!n.includes(\"throw\"))return!1;t._log.makeError(e).throw()}return!0}}}},function(e,t){e.exports=function(e={}){function t(e){throw new Error(\"Missing dependency for timer.class.js: \"+e)}const r=e.BetterLog||t(\"BetterLog\"),n=e.BetterEvents||t(\"BetterEvents\");function i(e=null,t=null,i){var o=this;function s(){var e=o._private,t={now:(new Date).getTime()};return t.timeSinceLastStart=e.start?t.now-e.start:0,t.elapsed=Math.max(e.elapsed+t.timeSinceLastStart,0),t.remaining=\"number\"!=typeof e.remaining?null:Math.max(e.remaining-t.timeSinceLastStart,0),t.nextInterval=\"number\"!=typeof e.nextInterval?null:Math.max(e.lastInterval||t.now+e.interval-t.now,0),t}function a(){var e=s();o._private.lastInterval=e.now,o.emit(\"interval\",e.elapsed,e.remaining)}function c(e,t,r){e&&\"number\"!=typeof e&&o._log.throwType(\"arg #1 to be falsey or a number\",e),t&&\"number\"!=typeof t&&o._log.throwType(\"arg #2 to be falsey or a number\",t),o._private.nextInterval=o._private.interval=e||null,o._private.timeout=o._private.remaining=t||null,o._private.elapsed=0,o._private.lastInterval=0,r&&o.adjustElapsed(r)}n.call(this),this.running=!1,Object.defineProperty(this,\"_log\",{value:new r(this)}),Object.defineProperty(this,\"_private\",{value:{timeoutIds:[]}}),this.getRemaining=function(){return this.running?s().remaining:o._private.remaining},this.getElapsed=function(e){return this.running?s().elapsed:o._private.elapsed},this.pause=function(){if(this.running){var e,t=s();for(Object.assign(this._private,t),this.running=!1;e=this._private.timeoutIds.pop();)clearTimeout(e);return!0}return!1},this.resume=function(){return!this.running&&(this._private.start=s().now,this.running=!0,\"number\"==typeof this._private.nextInterval&&this._private.timeoutIds.push(setTimeout(()=>{a(),this._private.timeoutIds.push(setInterval(a,o._private.interval))},this._private.nextInterval)),\"number\"==typeof this._private.remaining&&this._private.timeoutIds.push(setTimeout(()=>{o.pause(),o.emit(\"timeout\",o._private.timeout)},this._private.remaining)),!0)},this.reset=function(e=!0,t=!0,r){this.pause(),e=!0===e?o._private.interval:e,t=!0===t?o._private.timeout:t;try{return o._log.debug(\"Resetting timer with:\",e,t,r),c(e,t,r),!0}catch(e){return o._log.error(\"Failed to reset timer\",e),!1}},this.restart=function(){return!!this.reset.apply(this,Object.values(arguments))&&(this.resume(),!0)},this.adjustElapsed=function(e){try{if(\"number\"!=typeof e&&o._log.throwType(\"number\",e),o._private.timeout&&e>o._private.timeout||e<0)throw new RangeError(\"Valid range 0-\"+o._private.timeout+\", got \"+e)}catch(e){return void o._log.error(\"Failed to adjust elapsed time\",e)}var t=this.pause();if(e!=this._private.elapsed){this._private.elapsed=e;let t=o._private.interval;t&&(o._private.nextInterval=Math.ceil(e/t)*t-e),o._private.timeout&&(o._private.remaining=o._private.timeout-e),o._log.info(`Elapsed time set to: ${this._private.elapsed} of ${o._private.timeout}`)}else o._log.debug(`No change, timer is still set at: ${this._private.elapsed}`);t&&this.resume()},this.setTimeout=function(e){e&&\"number\"!=typeof e&&o._log.throwType(\"number|falsey\",e);var t=this.pause();o._private.timeout=e||null,o._private.remaining=e?e-this._private.elapsed:null,t&&this.resume()},c(e,t,i)}return i.prototype=Object.create(n.prototype),Object.defineProperty(i.prototype,\"constructor\",{value:i}),i}},function(e,t){throw new Error(\"Module parse failed: Unexpected token (1118:105)\\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\\n| \\t\\t//To get the real width, check every single row for the largest number of columns\\n| \\t\\tObject.defineProperty(obj,'width',{enumerable:true, get:()=>\\n> \\t\\t\\tArray.from(obj._table.querySelectorAll('tr')).reduce((max,tr)=>Math.max(max,tr.childElementCount()),0);\\n| \\t\\t})\\n| \")},function(e,t,r){\"use strict\";\n/*\n* @module bu-browser-styling\n* @author plundell\n* @license MIT\n* @description Helper functions related to css styling\n*\n* This module is required by bu-browser\n*/e.exports=function({cX:e,elemX:t}){const r=e._log;var n={increaseBrightness:function(e,t){3==(e=e.replace(/^\\s*#|\\s*$/g,\"\")).length&&(e=e.replace(/(.)/g,\"$1$1\"));var r=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),i=parseInt(e.substr(4,2),16);return\"#\"+(0|256+r+(256-r)*(t/=100)).toString(16).substr(1)+(0|256+n+(256-n)*t).toString(16).substr(1)+(0|256+i+(256-i)*t).toString(16).substr(1)},scrollBarWidth:function(){var e=document.createElement(\"div\");e.style=\"width: 100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;\",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},colorNameToHex:function(e){return e=e.toUpperCase(),i.hasOwnProperty(e)?i[e]:i.GRAY},createCSSRule:function(e,t,n=!1){if(!document.styleSheets||0==document.getElementsByTagName(\"head\").length)throw new Error(\"This document/browser doesn't support creating CSS selectors\");var i=a().filter(e=>{if(e.disabled)return!1;let t=\"string\"==typeof e.media?e.media:e.media.mediaText;return!t||\"all\"==t||t.indexOf(\"screen\")>-1});try{if(n){let n=s(e,i);return n.cssText=t,r.debug(\"Replaced existing CSS rule\",n),n}}catch(e){r.warn(\"Failed to replace existing rule, will try to append next...\",e)}try{return o(i.pop(),e,t)}catch(e){r.warn(\"Failed to add rule to existing stylesheet, will try creating own stylesheet next...\",e)}try{var c=document.createElement(\"style\");return c.type=\"text/css\",document.head.appendChild(c),o(c,e,t)}catch(e){r.throw(\"Failed to create a CSS rule in an existing or new styleSheet.\",e)}},appendCSSRule:o,findCSSRule:s,getSameOriginStylesheets:a};var i={WHITE:\"#FFFFFF\",AZURE:\"#FFFFFF\",MINTCREAM:\"#FFFFFF\",SNOW:\"#FFFFFF\",IVORY:\"#FFFFFF\",GHOSTWHITE:\"#FFFFFF\",FLORALWHITE:\"#FFFFFF\",ALICEBLUE:\"#FFFFFF\",LIGHTCYAN:\"#CCFFFF\",HONEYDEW:\"#FFFFFF\",LIGHTYELLOW:\"#FFFFFF\",SEASHELL:\"#FFFFFF\",LAVENDERBLUSH:\"#FFFFFF\",WHITESMOKE:\"#FFFFFF\",OLDLACE:\"#FFFFFF\",CORNSILK:\"#FFFFCC\",LINEN:\"#FFFFFF\",LIGHTGOLDENRODYELLOW:\"#FFFFCC\",LEMONCHIFFON:\"#FFFFCC\",BEIGE:\"#FFFFCC\",LAVENDER:\"#CCCCFF\",PAPAYAWHIP:\"#FFFFCC\",MISTYROSE:\"#FFCCCC\",ANTIQUEWHITE:\"#FFFFCC\",BLANCHEDALMOND:\"#FFFFCC\",BISQUE:\"#FFFFCC\",PALETURQUOISE:\"#99FFFF\",MOCCASIN:\"#FFCCCC\",GAINSBORO:\"#CCCCCC\",PEACHPUFF:\"#FFCCCC\",NAVAJOWHITE:\"#FFCC99\",PALEGOLDENROD:\"#FFFF99\",WHEAT:\"#FFCCCC\",POWDERBLUE:\"#CCCCFF\",AQUAMARINE:\"#66FFCC\",LIGHTGREY:\"#CCCCCC\",PINK:\"#FFCCCC\",LIGHTBLUE:\"#99CCFF\",THISTLE:\"#CCCCCC\",LIGHTPINK:\"#FFCCCC\",LIGHTSKYBLUE:\"#99CCFF\",PALEGREEN:\"#99FF99\",LIGHTSTEELBLUE:\"#99CCCC\",KHAKI:\"#FFCC99\",SKYBLUE:\"#99CCFF\",AQUA:\"#00FFFF\",CYAN:\"#00FFFF\",SILVER:\"#CCCCCC\",PLUM:\"#CC99CC\",GRAY:\"#CCCCCC\",LIGHTGREEN:\"#99FF99\",VIOLET:\"#FF99FF\",YELLOW:\"#FFFF00\",TURQUOISE:\"#33CCCC\",BURLYWOOD:\"#CCCC99\",GREENYELLOW:\"#99FF33\",TAN:\"#CCCC99\",MEDIUMTURQUOISE:\"#33CCCC\",LIGHTSALMON:\"#FF9966\",MEDIUMAQUAMARINE:\"#66CC99\",DARKGRAY:\"#999999\",ORCHID:\"#CC66CC\",DARKSEAGREEN:\"#99CC99\",DEEPSKYBLUE:\"#00CCFF\",SANDYBROWN:\"#FF9966\",GOLD:\"#FFCC00\",MEDIUMSPRINGGREEN:\"#00FF99\",DARKKHAKI:\"#CCCC66\",CORNFLOWERBLUE:\"#6699FF\",HOTPINK:\"#FF66CC\",DARKSALMON:\"#FF9966\",DARKTURQUOISE:\"#00CCCC\",SPRINGGREEN:\"#00FF66\",LIGHTCORAL:\"#FF9999\",ROSYBROWN:\"#CC9999\",SALMON:\"#FF9966\",CHARTREUSE:\"#66FF00\",MEDIUMPURPLE:\"#9966CC\",LAWNGREEN:\"#66FF00\",DODGERBLUE:\"#3399FF\",YELLOWGREEN:\"#99CC33\",PALEVIOLETRED:\"#CC6699\",MEDIUMSLATEBLUE:\"#6666FF\",MEDIUMORCHID:\"#CC66CC\",CORAL:\"#FF6666\",CADETBLUE:\"#669999\",LIGHTSEAGREEN:\"#339999\",GOLDENROD:\"#CC9933\",ORANGE:\"#FF9900\",LIGHTSLATEGRAY:\"#669999\",FUCHSIA:\"#FF00FF\",MAGENTA:\"#FF00FF\",MEDIUMSEAGREEN:\"#33CC66\",PERU:\"#CC9933\",STEELBLUE:\"#3399CC\",ROYALBLUE:\"#3366CC\",SLATEGRAY:\"#669999\",TOMATO:\"#FF6633\",DARKORANGE:\"#FF9900\",SLATEBLUE:\"#6666CC\",LIMEGREEN:\"#33CC33\",LIME:\"#00FF00\",INDIANRED:\"#CC6666\",DARKORCHID:\"#9933CC\",BLUEVIOLET:\"#9933FF\",DEEPPINK:\"#FF0099\",DARKGOLDENROD:\"#CC9900\",CHOCOLATE:\"#CC6633\",DARKCYAN:\"#009999\",DIMGRAY:\"#666666\",OLIVEDRAB:\"#669933\",SEAGREEN:\"#339966\",TEAL:\"#009999\",DARKVIOLET:\"#9900CC\",MEDIUMVIOLETRED:\"#CC0066\",ORANGERED:\"#FF3300\",OLIVE:\"#999900\",SIENNA:\"#996633\",DARKSLATEBLUE:\"#333399\",DARKOLIVEGREEN:\"#666633\",FORESTGREEN:\"#339933\",CRIMSON:\"#CC0033\",BLUE:\"#0000FF\",DARKMAGENTA:\"#990099\",DARKSLATEGRAY:\"#336666\",SADDLEBROWN:\"#993300\",BROWN:\"#993333\",FIREBRICK:\"#993333\",PURPLE:\"#990099\",GREEN:\"#009900\",RED:\"#FF0000\",MEDIUMBLUE:\"#0000CC\",INDIGO:\"#330099\",MIDNIGHTBLUE:\"#000066\",DARKGREEN:\"#006600\",DARKBLUE:\"#000099\",NAVY:\"#000099\",DARKRED:\"#990000\",MAROON:\"#990000\",BLACK:\"#000000\"};function o(t,n,i){if(\"node\"==e.varType(t)){if(t.sheet)return o(t.sheet,n,i);r.makeTypeError(\"a <style> elem\",t).throw()}var s;if(e.checkTypes([\"<CSSStyleSheet>\",\"string\",\"string\"],arguments),\"function\"==typeof t.insertRule){var a=t.insertRule(`${n}{${i}}`,t.cssRules.length);a!=t.cssRules.length-1&&r.warn(`A CSS rule was inserted at index ${a}, which is not the end`,t.cssRules),s=t.cssRules[a]}else\"function\"==typeof t.addRule&&(t.addRule(n,i),s=t.rules[t.length-1]);if(s)return s;r.makeError(\"No rule was created. Dont know why? Called with:\",arguments).throw()}function s(e,t=null){for(var r of t=Array.from(t)||a()){let t=\"string\"==typeof r.media?r.rules:r.cssRules,i=t.length;for(var n=0;n<i;n++)if(t[n].selectorText&&t[n].selectorText.toLowerCase()==e.toLowerCase())return t[n]}}function a(){return document.styleSheets&&document.styleSheets.length?Array.from(document.styleSheets).filter(e=>{try{return e.cssRules||e.rules,!0}catch(e){return!1}}):[]}return n}},function(e,t){e.exports=function({cX:e,elemX:t}){const r=e._log;var n={detectSwipe:function(...n){var o=e.getFirstOfType(n,\"function\")||r.makeError(\"No callback function given\").setCode(\"EINVAL\").throw(),s=t.getLiveElement(e.getFirstOfType(n,\"node\")||e.getFirstOfType(n,\"string\")||window),a=e.getFirstOfType(n,\"number\")||90,c=(e.getFirstOfType(n,\"boolean\"),!!i&&{passive:!0,capture:!1}),u=0,l=0,h=0,p=0;s.addEventListener(\"touchstart\",(function(e){if(h=u=e.touches[0].screenX,p=l=e.touches[0].screenY,t){var t=function(e){e.preventDefault(),s.removeEventListener(\"touchmove\",t)};s.addEventListener(\"touchmove\",t)}}),c),s.addEventListener(\"touchend\",(function(e){h=e.changedTouches[0].screenX,p=e.changedTouches[0].screenY;let t=h-u,n=p-l;var i=!1;if(Math.abs(t)>a){i=!0;let e=t>0?\"right\":\"left\";r.debug(\"detected swipe \"+e,{deltaX:t,deltaMin:a}),o(e)}if(Math.abs(n)>a){i=!0;let e=n>0?\"up\":\"down\";r.debug(\"detected swipe \"+e,{deltaY:n,deltaMin:a}),o(e)}i||!n&&!t||r.trace(\"no swipe, too short...\",{deltaX:t,deltaY:n,deltaMin:a})}),c)},getZoom:function(){return document.documentElement.clientWidth/window.innerWidth}},i=!1;try{var o=Object.defineProperty({},\"passive\",{get:function(){i=!0}});window.addEventListener(\"testPassive\",null,o),window.removeEventListener(\"testPassive\",null,o)}catch(e){}return n}},function(e,t){e.exports=function({cX:e}){const t=e._log;return{POST:function(e,r,n){t._isLog(n)||(n=t);if(\"string\"!=typeof e)return n.rejectType(\"arg#1 to be string target, eg. api.php\",e);var{promise:i,resolve:o,reject:s,inspect:a}=xxx.util.exposedPromise();try{var c=new XMLHttpRequest;c.addEventListener(\"abort\",(function(e){s(n.makeError(\"Request aborted.\",e).setCode(\"abort\").exec())})),c.addEventListener(\"timeout\",(function(e){s(n.makeError(\"Request timed out.\",e).setCode(\"timeout\").exec())})),c.addEventListener(\"loadend\",(function(){if(this.status>=200&&this.status<300)n.info(`Got successfull ${this.status} response from ${e}:`,this.response),o(this.response);else if(\"pending\"==a.status){var t=n.makeError(e).setCode(this.status).somewhere(this.response);s(t)}})),n.info(`About to POST to ${e}:`,r);let t=JSON.stringify(r);c.open(\"POST\",e,!0),c.setRequestHeader(\"Content-Type\",\"application/json\"),c.send(t)}catch(e){s(n.makeError(e).setCode(\"BUGBUG\").exec())}return i}}}}]);","extractedComments":[]}